{
  "version": 3,
  "sources": [
    "node_modules/browser-pack/_prelude.js",
    "src/BasicGame.js",
    "src/classes/Days.js",
    "src/classes/Eye.js",
    "src/classes/Helper.js",
    "src/classes/Level.js",
    "src/classes/Light.js",
    "src/classes/Lightning.js",
    "src/classes/Player.js",
    "src/index.js",
    "src/states/Boot.js",
    "src/states/Credits.js",
    "src/states/Game.js",
    "src/states/GameOver.js",
    "src/states/Intro.js",
    "src/states/MainMenu.js",
    "src/states/Preloader.js",
    "src/states/TheEnd.js"
  ],
  "names": [],
  "mappings": "AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1pBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "file": "generated.js",
  "sourceRoot": "",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "var BasicGame = {\r\n  language: \"en\",\r\n  currentLevel: 10,\r\n  deaths: 0,\r\n  rest: 0,\r\n  setDay: function(n) {\r\n    this.currentLevel = (n < 10) ? ('0' + n) : n;\r\n    return this.getCode();\r\n  },\r\n  addDeath: function() {\r\n    this.deaths++;\r\n    return this.getCode();\r\n  },\r\n  setRest: function() {\r\n    this.rest = 1;\r\n    return this.getCode();\r\n  },\r\n  getCode: function() {\r\n    return this.rest + '' + this.deaths + '' + this.currentLevel;\r\n  },\r\n  readCode: function(code) {\r\n    if (code.length < 4) return;\r\n\r\n    this.currentLevel = parseInt(code.slice(code.length -2, code.length));\r\n    this.deaths = parseInt(code.slice(1, code.length - 2));\r\n    this.rest = parseInt(code.charAt(0));\r\n  },\r\n  getDeaths: function() {\r\n    return this.deaths;\r\n  },\r\n  reset: function() {\r\n    this.currentLevel = 1;\r\n    this.deaths = 0;\r\n    this.rest = 0;\r\n  }\r\n};\r\n\r\nmodule.exports = BasicGame;",
    "// levels for testing:\r\n// 4 (free space for testing jumps)\r\nvar BasicGame = require('BasicGame');\r\n\r\nBasicGame.Days = function () {\r\n  this.days = {\r\n    1:  { \"number\": 387,\r\n          \"text\": {\r\n            \"en\": \"Maybe it will be there forever\",\r\n            \"es\": \"Tal vez siempre estará ahí\"\r\n          },\r\n          \"waitTime\": 3\r\n        },\r\n    2:  { \"number\": 349,\r\n          \"text\": {\r\n            \"en\": \"Sometimes it comes back\",\r\n            \"es\": \"A veces vuelve\"\r\n          },\r\n          \"waitTime\": 4\r\n        },\r\n    3:  { \"number\": 313,\r\n          \"text\": {\r\n            \"en\": \"It is here...again\",\r\n            \"es\": \"Aquí está...otra vez\"\r\n          },\r\n          \"waitTime\": 3\r\n        },\r\n    4:  { \"number\": 248,\r\n          \"text\": {\r\n            \"en\": \"Why am I thinking about that?\",\r\n            \"es\": \"¿Por qué estoy pensando en eso?\"\r\n          },\r\n          \"waitTime\": 3\r\n        },\r\n    5:  { \"number\": 212,\r\n          \"text\": {\r\n            \"en\": \"It's here\",\r\n            \"es\": \"Aquí está\"\r\n          },\r\n          \"waitTime\": 4 \r\n        },\r\n    6:  { \"number\": 186,\r\n          \"text\": {\r\n            \"en\": \"No again, please\",\r\n            \"es\": \"Otra vez? no por favor\"\r\n          },\r\n          \"waitTime\": 4 \r\n        },\r\n    7:  { \"number\": 171,\r\n          \"text\": {\r\n            \"en\": \"I thought I had overcome it\",\r\n            \"es\": \"Pensé que lo había superado\"\r\n          },\r\n          \"waitTime\": 4 \r\n        },\r\n    8:  { \"number\": 156,\r\n          \"text\": {\r\n            \"en\": \"Another day...and it's here\",\r\n            \"es\": \"Otro día...y aquí está\"\r\n          },\r\n          \"waitTime\": 4 \r\n        },\r\n    9:  { \"number\": 101,\r\n          \"text\": {\r\n            \"en\": \"I'm thinking about it\",\r\n            \"es\": \"Estoy pensando en eso\"\r\n          },\r\n          \"waitTime\": 4 \r\n        },\r\n    10: { \"number\": 90,\r\n          \"text\": {\r\n            \"en\": \"(peaceful days)\",\r\n            \"es\": \"(días tranquilos)\"\r\n          },\r\n          \"waitTime\": 5\r\n        },\r\n    11: { \"number\": 83,\r\n          \"text\": {\r\n            \"en\": \"What I have done is not as wrong as I thought\",\r\n            \"es\": \"Lo que hice no es tan malo como pensaba\"\r\n          },\r\n          \"waitTime\": 5\r\n        },\r\n    12: { \"number\": 74,\r\n          \"text\": {\r\n            \"en\": \"I can't believe no one cares about it\",\r\n            \"es\": \"No puedo creer que ha nadie le haya importado\"\r\n          },\r\n          \"waitTime\": 5\r\n        },\r\n    13: { \"number\": 68,\r\n          \"text\": {\r\n            \"en\": \"Two months has passed and no one talks about it, that's good\",\r\n            \"es\": \"Han pasado más de dos meses y nadie ha dicho nada, eso es bueno\"\r\n          },\r\n          \"waitTime\": 6\r\n        },\r\n    14: { \"number\": 65,\r\n          \"text\": {\r\n            \"en\": \"I must admit it, my life has improved after that\",\r\n            \"es\": \"Debo reconocer que mi vida a mejorado después de eso\"\r\n          },\r\n          \"waitTime\": 5\r\n        },\r\n    15: { \"number\": 59,\r\n          \"text\": {\r\n            \"en\": \"It is odd, is not affecting me\",\r\n            \"es\": \"Qué extraño, empieza a no afectarme\"\r\n          },\r\n          \"waitTime\": 3\r\n        },\r\n    16: { \"number\": 47,\r\n          \"text\": {\r\n            \"en\": \"No one have been noticed it...could be so insignificant?\",\r\n            \"es\": \"Aún nadie lo ha notado...¿puede ser tan insignificante?\"\r\n          },\r\n          \"waitTime\": 5\r\n        },\r\n    17: { \"number\": 35,\r\n          \"text\": {\r\n            \"en\": \"How could I thought it isn't wrong? It is wrong!\",\r\n            \"es\": \"¿Cómo pude pensar que no es malo? Es muy malo!\"\r\n          },\r\n          \"waitTime\": 4\r\n        },\r\n    18: { \"number\": 28,\r\n          \"text\": {\r\n            \"en\": \"Maybe it isn't as wrong as I thought\",\r\n            \"es\": \"Tal vez no es algo tan malo como pensaba\"\r\n          },\r\n          \"waitTime\": 4\r\n        },\r\n    19: { \"number\": 16,\r\n          \"text\": {\r\n            \"en\": \"No one cares about it, that's weird\",\r\n            \"es\": \"Nadie lo ha notado, qué extraño\"\r\n          },\r\n          \"waitTime\": 4\r\n        },\r\n    20: { \"number\": 11,\r\n          \"text\": {\r\n            \"en\": \"(cool down days)\",\r\n            \"es\": \"(dían de calma)\"\r\n          },\r\n          \"waitTime\": 3\r\n        },\r\n    21: { \"number\": 9,\r\n          \"text\": {\r\n            \"en\": \"I'm a bad person\",\r\n            \"es\": \"Soy una mala persona\"\r\n          },\r\n          \"waitTime\": 3\r\n        },\r\n    22: { \"number\": 8,\r\n          \"text\": {\r\n            \"en\": \"What if someone goes to the appartment?\",\r\n            \"es\": \"¿Qué tal si alguien va al apartamento?\"\r\n          },\r\n          \"waitTime\": 4\r\n        },\r\n    23: { \"number\": 7,\r\n          \"text\": {\r\n            \"en\": \"How could I do it?...how could I?\",\r\n            \"es\": \"¿Cómo pude hacerlo?...¿cómo pude?\"\r\n          },\r\n          \"waitTime\": 3\r\n        },\r\n    24: { \"number\": 6,\r\n          \"text\": {\r\n            \"en\": \"Brother: You have to calm down, I told you it wouldn't be easy\",\r\n            \"es\": \"Hermano: Tienes que calmarte, te dije que no sería fácil\"\r\n          },\r\n          \"waitTime\": 5\r\n        },\r\n    25: { \"number\": 5,\r\n          \"text\": {\r\n            \"en\": \"I must talk with my brother\",\r\n            \"es\": \"Tengo que hablar con mi hermano\"\r\n          },\r\n          \"waitTime\": 4\r\n        },\r\n    26: { \"number\": 4,\r\n          \"text\": {\r\n            \"en\": \"Don't don't don't...there must be something I can do\",\r\n            \"es\": \"No no no no!...debe haber algo que pueda hacer\"\r\n          },\r\n          \"waitTime\": 6\r\n        },\r\n    27: { \"number\": 3,\r\n          \"text\": {\r\n            \"en\": \"I have to tell everything...I...must...\",\r\n            \"es\": \"Tengo que contarlo todo...tengo...que...\"\r\n          },\r\n          \"waitTime\": 6\r\n        },\r\n    28: { \"number\": 2,\r\n          \"text\": {\r\n            \"en\": \"...maybe she deserved it...but..who am I to judge?\",\r\n            \"es\": \"...tal vez sí lo merecía...pero...¿quién soy yo para juzgar?\"\r\n          },\r\n          \"waitTime\": 7\r\n        },\r\n    29: { \"number\": 1,\r\n          \"text\": {\r\n            \"en\": \"She didn't deserve it...\",\r\n            \"es\": \"Ella no se lo merecía...\"\r\n          },\r\n          \"waitTime\": 3\r\n        },\r\n    30: { \"number\": 0,\r\n          \"text\": {\r\n            \"en\": \"...oh...what I've done?\",\r\n            \"es\": \"...pero...¿qué he hecho?\"\r\n          },\r\n          \"waitTime\": 3\r\n        }\r\n  };\r\n};\r\n\r\nBasicGame.Days.prototype.getDay = function(dayIndex){\r\n  if(!this.days[dayIndex]) return {\"number\": \"???\"};\r\n  return this.days[dayIndex];\r\n};",
    "var BasicGame = require('BasicGame');\r\n\r\n/**\r\nThe MIT License (MIT)\r\nCopyright (c) <year> <copyright holders>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n\r\n/**\r\n * Method that set the default values for the properties of the Eye object.\r\n * \r\n * @param {Object} game    The Object of Phaser game\r\n * @param {Object} gameObj The Object of BasicGame.Game\r\n */\r\nBasicGame.Eye = function (game, gameObj) {\r\n  this.game = game;\r\n  this.gameObj = gameObj;\r\n  this.eye = null;\r\n  this.playerObj = null;\r\n  this.level = null;\r\n  this.lightning = null;\r\n  this.bitmap = null;\r\n  this.anger = null;\r\n  this.shooting = null;\r\n  this.searching = null;\r\n  this.searchingTime = 19000;\r\n  this.zoneSize = this.game.world.width / 3;\r\n  this.viewZoneSprite = null;\r\n  this.laughSound = null;\r\n  this.angerSound = null;\r\n  this.currentPattern = -1;\r\n  this.levelEnded = null;\r\n  this.usedPatterns = null;\r\n};\r\n\r\n/**\r\n * Method that runs when the Eye Object is created.\r\n * \r\n * @param  {Object} playerObj The Object of the BasicGame.Player\r\n * @param  {Object} level     The Object of the BasicGame.Level\r\n * @param  {Object} lightning The Object of the BasicGame.Lightning\r\n */\r\nBasicGame.Eye.prototype.create = function (playerObj, level, lightning) {\r\n  // set the default values for some properties\r\n  this.playerObj = playerObj;\r\n  this.level = level;\r\n  this.lightning = lightning;\r\n  this.shooting = false;\r\n  this.searching = false;\r\n  this.levelEnded = false;\r\n  this.usedPatterns = 0;\r\n\r\n  // add the sprite of the eye\r\n  this.eye = this.game.add.sprite(this.game.world.width / 2, 64, 'eye', 0);\r\n  this.eye.originalX = this.eye.x;\r\n  this.eye.originalY = this.eye.y;\r\n  this.eye.anchor.setTo(0.5, 0.5);\r\n\r\n  // add the  sprite of the pupil\r\n  this.pupil = this.game.add.image(this.eye.x, this.eye.y, 'pupil');\r\n  this.pupil.alpha = 0;\r\n  this.pupil.anchor.setTo(0.5, 0.5);\r\n  \r\n  // create the array of key positions for the pupil (this will be linked to\r\n  // the position of the view zone)\r\n  this.pupilImagePositions = {\r\n    '3': this.eye.x - 16 * 3,\r\n    '2': this.eye.x - 16 * 2,\r\n    '1': this.eye.x - 16 * 1,\r\n    '0': this.eye.x,\r\n    '4': this.eye.x + 16 * 1,\r\n    '5': this.eye.x + 16 * 2,\r\n    '6': this.eye.x + 16 * 3\r\n  };\r\n\r\n  // create the view zones\r\n  this.viewZoneSprite = this.game.add.sprite(this.eye.position.x - this.zoneSize / 2, 0, 'view_zone', 0);\r\n  this.viewZoneSprite.tint = 0xFFFC19;\r\n  this.viewZoneSprite.alpha = 0;\r\n  this.viewZoneSprite.width = this.zoneSize;\r\n  this.viewZoneSprite.height = this.game.world.height;\r\n\r\n  // calculate and store the key positions of the view zone\r\n  var zoneDiv = this.zoneSize / 3;\r\n  this.viewZoneSprite.positions = {\r\n    '3': 0,\r\n    '2': zoneDiv,\r\n    '1': zoneDiv * 2,\r\n    '0': this.viewZoneSprite.position.x,\r\n    '4': this.viewZoneSprite.position.x + zoneDiv,\r\n    '5': this.viewZoneSprite.position.x + zoneDiv * 2,\r\n    '6': this.game.world.width - this.zoneSize\r\n  };\r\n\r\n  // (!) define the patterns for the EYE\r\n  this.patterns = [\r\n    [[0,3,2], [3, 6, 4], [6, 0, 2]],\r\n    [[0,1,0.5], [1, 4, 1], [4, 2, 1], [2, 5, 2], [5, 0, 1]],\r\n    [[0,3,0.2], [3, 6, 0.4], [6, 0, 0.2]],\r\n    [[0,4,0.5], [4, 1, 1], [1, 5, 1], [5, 2, 2], [2, 0, 1]]\r\n  ];\r\n\r\n  // ---------------------------------------------------------------------------\r\n  // setup the animations for THE EYE\r\n  this.eye.animations.add('search', [0], 1, false);\r\n  this.eye.animations.add('angry', [7], 1, false);\r\n  this.eye.animations.add('tired', [8], 1, false);\r\n  this.eye.animations.add('happy', [9], 1, false);\r\n  this.eye.animations.add('irritated', [10], 1, false);\r\n\r\n  // create a bitmap texture for drawing lines\r\n  if(BasicGame.Game.developmentMode === true) { // [ development mode ]\r\n    this.bitmap = this.game.add.bitmapData(this.game.width, this.game.height);\r\n    this.bitmap.context.fillStyle = 'rgb(255, 255, 255)';\r\n    this.bitmap.context.strokeStyle = 'rgb(255, 255, 255)';\r\n    this.game.add.image(0, 0, this.bitmap);\r\n  }\r\n\r\n  // create the lightning for killing the player\r\n  this.lightning.create(this.eye, this.playerObj, this.level);\r\n  this.lightningTimer = 0;\r\n\r\n  // the EYE starts calm\r\n  this.anger = false;\r\n\r\n  // ---------------------------------------------------------------------------\r\n  // setup the sounds\r\n  if (!this.laughSound) {\r\n    this.laughSound = this.game.add.sound('eye', 0.1);\r\n  }\r\n\r\n  if (!this.angerSound) {\r\n    this.angerSound = this.game.add.sound('eye-anger', 0.8);\r\n  }\r\n};\r\n\r\n/**\r\n * Method that runs each time the game runs the update method.\r\n */\r\nBasicGame.Eye.prototype.update = function () {\r\n  var checkLeft = false,\r\n      checkRight = false;\r\n\r\n  if(BasicGame.Game.developmentMode === true) { // [ development mode ]\r\n    // clear the bitmap where we are drawing our lines\r\n    this.bitmap.context.clearRect(0, 0, this.game.width, this.game.height);\r\n  }\r\n\r\n  if (this.eye.animations.currentAnim.name === 'happy' ||\r\n      this.levelEnded === true) {\r\n    // the player is dead, I'm the happiest EYE in the hole universe\r\n    return;\r\n  }\r\n\r\n  if(this.gameObj.isLoadingLevel === true) {\r\n    // the EYE will start the level as irritated (sleeping)\r\n    this.eye.animations.play('irritated');\r\n    return;\r\n  }\r\n\r\n  // ---------------------------------------------------------------------------\r\n  // ray casting\r\n\r\n  // test if the target can see the eye by casting a ray (a line) towards the eye.\r\n  // if the ray intersects any walls before it intersects the eye then the wall\r\n  // is in the way.\r\n  if (BasicGame.Game.developmentMode === true) { // [ development mode ]\r\n    if (this.isPlayerInsideViewZone() === true) {\r\n      this.playerObj.player.tint = 0x990000;\r\n    }\r\n    else {\r\n      this.playerObj.player.tint = 0xFFFFFF;\r\n    }\r\n  }\r\n\r\n  // check if the player is in the side of vision of the EYE\r\n  if (this.searching === true && this.isPlayerInsideViewZone() === true) {\r\n    // check which of the points in the player should be used for \"in shadow\"\r\n    // evaluation\r\n    if (this.playerObj.player.left > this.viewZoneSprite.left) {\r\n      checkLeft = true;\r\n    }\r\n\r\n    if (this.playerObj.player.right < this.viewZoneSprite.right) {\r\n      checkRight = true;\r\n    }\r\n\r\n    if (this.playerObj.isInShadow(checkLeft, checkRight) === false) {\r\n      if (BasicGame.Game.developmentMode === true) { // [ development mode ]\r\n        this.playerObj.player.tint = 0xEECC00;\r\n      }\r\n\r\n      // shoot to the player\r\n      this.shootPlayer(this.playerObj.player);\r\n    }\r\n    else {\r\n      if (BasicGame.Game.developmentMode === true) { // [ development mode ]\r\n        this.playerObj.player.tint = 0x990000;\r\n      }\r\n    }\r\n  }\r\n\r\n  // This just tells the engine it should update the texture cache\r\n  if(BasicGame.Game.developmentMode === true) { // [ development mode ]\r\n    this.bitmap.dirty = true;\r\n  }\r\n};\r\n\r\n/**\r\n * Method that checks if the player is inside the view zone of the EYE.\r\n */\r\nBasicGame.Eye.prototype.isPlayerInsideViewZone = function () {\r\n  if (this.viewZoneSprite.alpha > 0) {\r\n    return (this.playerObj.player.left > this.viewZoneSprite.left || this.playerObj.player.right > this.viewZoneSprite.left) &&\r\n           (this.playerObj.player.right < this.viewZoneSprite.right || this.playerObj.player.left < this.viewZoneSprite.right);\r\n  }\r\n  return false;\r\n};\r\n\r\n/**\r\n * Method that define the pattern for seeking the player, setup and plays the\r\n * tweens for both the pupil and the view zone.\r\n * \r\n * @param  {boolean} delay Defines if the seeking should be wait a while before\r\n *                         starting\r\n */\r\nBasicGame.Eye.prototype.initSearch = function (delay) {\r\n  var newPatternIndex = -1,\r\n      intent = 0,\r\n      pattern = null,\r\n      patternReversed = null,\r\n      index = 0,\r\n      lap = 0,\r\n      positionIndex = -1;\r\n\r\n  // remove the tweens for the pupil and the view zone\r\n  this.viewZoneTween = undefined;\r\n  this.pupilTween = undefined;\r\n\r\n  // check if it is necessary to wait before starting the search\r\n  if (delay === true) {\r\n    this.gameObj.helper.timer(500,\r\n      function () {\r\n        this.initSearch();\r\n      },\r\n      this);\r\n    return;\r\n  }\r\n\r\n  // set the defaults for the pupil and the view zone\r\n  this.viewZoneSprite.x = this.viewZoneSprite.positions['0'];\r\n  this.viewZoneSprite.alpha = 0.05;\r\n  this.pupil.x = this.pupilImagePositions['0'];\r\n  this.pupil.alpha = 1;\r\n\r\n  // pick a pattern for searching in the array of available patterns\r\n  if (this.usedPatterns !== 0) {\r\n    do {\r\n      newPatternIndex = Math.floor(Math.random()*(this.patterns.length));\r\n      intent++;\r\n    } while (this.currentPattern === newPatternIndex || intent > 5);\r\n    this.currentPattern = newPatternIndex;\r\n  }\r\n  else\r\n  {\r\n    this.currentPattern = '0';\r\n  }\r\n  this.usedPatterns++;\r\n\r\n  // define if the pattern will be used reversed\r\n  patternReversed = Math.random() > 0.5 ? true : false;\r\n\r\n  // get the pattern to use\r\n  pattern = this.patterns[this.currentPattern];\r\n\r\n  // get the index of the initial step of the pattern\r\n  index = !patternReversed ? 0 : pattern.length - 1;\r\n\r\n  // iterate over the steps of the pattern and make the EYE move to each\r\n  // position of it\r\n  var iterator = function (index) {\r\n    if ((!patternReversed && index < pattern.length) ||\r\n        (patternReversed && index >= 0)) {\r\n      // set the initial X position of the EYE and the view zone\r\n      positionIndex = pattern[index][!patternReversed ? 0 : 1];\r\n      this.viewZoneSprite.x = this.viewZoneSprite.positions[positionIndex];\r\n      this.pupil.x = this.pupilImagePositions[positionIndex];\r\n\r\n      // setup the tweens that will move the pupil and the view zone\r\n      // TODO: replace tweens by basic calculations\r\n      this.tweenEye(pattern[index][!patternReversed ? 1 : 0],\r\n        pattern[index][2],\r\n        function () {\r\n          this.gameObj.helper.timer(1000,\r\n            function () {\r\n              if (this.levelEnded === true || this.shooting === true) {\r\n                return;\r\n              }\r\n              iterator(!patternReversed ? ++index : --index);\r\n            },\r\n            this);\r\n        }.bind(this));\r\n    }\r\n    else {\r\n      // if there are no more steps in the pattern\r\n      if (++lap < 2) {\r\n        // if the pattern was used twice, change it\r\n        this.gameObj.helper.timer(1000,\r\n          function () {\r\n            index = !patternReversed ? 0 : pattern.length - 1;\r\n            iterator(index);\r\n          },\r\n          this);\r\n      }\r\n      else {\r\n        if (this.shooting === true) {\r\n          // this is triggered when the player enters the view zone while the\r\n          // eye is looking to the front before getting tired\r\n          return;\r\n        }\r\n\r\n        this.searching = false;\r\n        this.getTired();\r\n      }\r\n    }\r\n  }.bind(this);\r\n  iterator(index);\r\n\r\n  // play the search animation in the EYE's sprite\r\n  this.eye.animations.play('search');\r\n\r\n  // set the flag that indicates if the EYE is seeking for the player\r\n  this.searching = true;\r\n\r\n};\r\n\r\n/**\r\n * Method that setup and  play the tweens for moving the pupil and the view zone.\r\n * \r\n * @param  {[type]}   target     [description]\r\n * @param  {[type]}   timeInSecs [description]\r\n * @param  {Function} callback   [description]\r\n * @return {[type]}              [description]\r\n */\r\nBasicGame.Eye.prototype.tweenEye = function (target, timeInSecs, callback) {\r\n  if (this.viewZoneTween && this.viewZoneTween.isRunning === true) return;\r\n\r\n  // start the tweens for movement\r\n  this.viewZoneTween = this.game.add.tween(this.viewZoneSprite)\r\n    .to({x: this.viewZoneSprite.positions[target]},\r\n      timeInSecs * 1000,\r\n      null,\r\n      false,\r\n      0,\r\n      0);\r\n  this.viewZoneTween.onComplete.add(function (sprite, tween) {\r\n    tween.stop();\r\n    callback();\r\n  }, this);\r\n  this.viewZoneTween.start();\r\n\r\n  this.pupilTween = this.game.add.tween(this.pupil)\r\n    .to({x: this.pupilImagePositions[target]},\r\n      timeInSecs * 1000,\r\n      null,\r\n      false,\r\n      0,\r\n      0);\r\n  this.pupilTween.onComplete.add(function (sprite, tween) {\r\n    tween.stop();\r\n  }, this);\r\n  this.pupilTween.start();\r\n};\r\n\r\n/**\r\n * Method that plays the 'tired' animation and makes the EYE get mad.\r\n */\r\nBasicGame.Eye.prototype.getTired = function () {\r\n  this.eye.animations.play('tired');\r\n\r\n  this.pupil.alpha = 0;\r\n  this.viewZoneSprite.alpha = 0;\r\n\r\n  this.getMadTimer = this.game.time.create(true);\r\n  this.getMadTimer.add(1200,\r\n    function () {\r\n      this.getMad();\r\n    },\r\n    this);\r\n\r\n  this.getMadTimer.start();\r\n};\r\n\r\n/**\r\n * Method that play the 'angry' animation of the EYE, shakes the camera and\r\n * restarts the seeking for the player.\r\n */\r\nBasicGame.Eye.prototype.getMad = function () {\r\n  // play the angry animation and the sound linked to it\r\n  this.eye.animations.play('angry');\r\n  this.angerSound.play();\r\n\r\n  // shake the world\r\n  this.shake();\r\n\r\n  // restart the search\r\n  this.searchAgain = this.game.time.create(true);\r\n  this.searchAgain.add(1600,\r\n    function () {\r\n      this.eye.x = this.eye.originalX;\r\n      this.initSearch();\r\n    },\r\n    this);\r\n  this.searchAgain.start();\r\n};\r\n\r\nBasicGame.Eye.prototype.shootPlayer = function (target) {\r\n  var tweensInPause = false;\r\n\r\n  if(BasicGame.Game.developmentMode === true) { // [ development mode ]\r\n    this.drawLinesToTarget(target);\r\n    this.playerObj.player.tint = 0x00ff00;\r\n  }\r\n\r\n  if (this.shooting === false) {\r\n    this.shooting = true;\r\n    this.searching = false;\r\n\r\n    this.eye.animations.play('angry');\r\n    this.lightning.shoot(target);\r\n\r\n    // hide the pupil while shooting\r\n    this.pupil.alpha = 0;\r\n\r\n    // pause the current tweens, if any, for the pupil and the viewzone\r\n    if ((this.viewZoneTween && this.viewZoneTween.isRunning === true) ||\r\n        (this.pupilTween && this.pupilTween.isRunning === true)) {\r\n      tweensInPause = true;\r\n      this.viewZoneTween.pause();\r\n      this.pupilTween.pause();\r\n    }\r\n\r\n    this.destroyTimers(this.getTiredTimer, this.getMadTimer, this.searchAgain);\r\n\r\n    // init the timer that will make the EYE calm down again and restart the\r\n    // search\r\n    this.calmDownTimer = this.game.time.create(true);\r\n    this.calmDownTimer.add(3000,\r\n      function () {\r\n        if (tweensInPause === true) {\r\n          this.eye.animations.play('search');\r\n          this.pupil.alpha = 1;\r\n          this.searching = true;\r\n\r\n          if (this.viewZoneTween && this.pupilTween) {\r\n            this.viewZoneTween.resume();\r\n            this.pupilTween.resume();\r\n          }\r\n        }\r\n        else {\r\n          this.initSearch();\r\n        }\r\n\r\n        var _self = this;\r\n        setTimeout(function () {\r\n          _self.shooting = false;\r\n        }, 200);\r\n      },\r\n      this);\r\n    this.calmDownTimer.start();\r\n  }\r\n};\r\n\r\nBasicGame.Eye.prototype.shake = function () {\r\n  this.shakeTween = this.shakeTween || this.game.add.tween(this.eye);\r\n  this.shakeTween.to({x: this.eye.originalX + 10},\r\n    40,\r\n    Phaser.Easing.Sinusoidal.InOut,\r\n    false,\r\n    0,\r\n    4,\r\n    true).start();\r\n  this.shakeTween.onComplete.add(function () {\r\n  }, this);\r\n};\r\n\r\nBasicGame.Eye.prototype.levelStart = function () {\r\n  this.levelEnded = false;\r\n  this.shooting = false;\r\n  this.initSearch();\r\n};\r\n\r\nBasicGame.Eye.prototype.endLevel = function (levelCompleted) {\r\n  if (this.levelEnded === true) return;\r\n\r\n  this.levelEnded = true;\r\n\r\n  this.destroyTimers();\r\n  this.searching = false;\r\n  this.shooting = false;\r\n\r\n  this.viewZoneTween.onComplete.removeAll();\r\n  this.pupilTween.onComplete.removeAll();\r\n\r\n  if (levelCompleted === true) {\r\n    this.pupil.alpha = 0;\r\n  }\r\n};\r\n\r\nBasicGame.Eye.prototype.gameInDarkness = function () {\r\n  this.eye.animations.play('search');\r\n  this.viewZoneSprite.x = this.viewZoneSprite.positions['0'];\r\n  this.viewZoneSprite.alpha = 0;\r\n  this.pupil.x = this.pupilImagePositions['0'];\r\n  this.pupil.alpha = 1;\r\n};\r\n\r\nBasicGame.Eye.prototype.destroyTimers = function () {\r\n  if (arguments.length === 0) {\r\n    if (this.calmDownTimer) {\r\n      this.calmDownTimer.destroy();\r\n    }\r\n\r\n    if (this.getTiredTimer) {\r\n      this.getTiredTimer.destroy();\r\n    }\r\n\r\n    if (this.getMadTimer) {\r\n      this.getMadTimer.destroy();\r\n    }\r\n\r\n    if (this.searchAgain) {\r\n      this.searchAgain.destroy();\r\n    }\r\n\r\n    return;\r\n  }\r\n\r\n  for (var i = arguments.length - 1; i >= 0; i--) {\r\n    if(arguments[i]) arguments[i].destroy();\r\n  }\r\n};\r\n\r\nBasicGame.Eye.prototype.rejoice = function (callback) {\r\n  this.destroyTimers();\r\n\r\n  this.eye.animations.play('happy');\r\n\r\n  this.viewZoneSprite.alpha = 0;\r\n\r\n  this.shakeTween = this.game.add.tween(this.eye);\r\n  this.shakeTween.to({y: this.eye.originalY + 10},\r\n    150,\r\n    null,\r\n    false,\r\n    0,\r\n    4,\r\n    true).start();\r\n  this.shakeTween.onComplete.add(function () {\r\n    this.shakeTween.stop();\r\n    this.eye.y = this.eye.originalY;\r\n    this.laughSound.stop();\r\n    callback();\r\n  }, this);\r\n\r\n  this.laughSound.play();\r\n};\r\n\r\nBasicGame.Eye.prototype.updateLevel = function (level) {\r\n  this.level = level;\r\n  this.anger = false;\r\n  this.usedPatterns = 0;\r\n\r\n  this.stopEyeTweens();\r\n};\r\n\r\nBasicGame.Eye.prototype.restartLevel = function () {\r\n  this.anger = false;\r\n  this.levelEnded = true;\r\n\r\n  this.stopEyeTweens();\r\n  this.destroyTimers();\r\n};\r\n\r\nBasicGame.Eye.prototype.stopEyeTweens = function () {\r\n  this.viewZoneTween.stop();\r\n  this.pupilTween.stop();\r\n};\r\n\r\nBasicGame.Eye.prototype.drawLinesToTarget = function (target) {\r\n  // draw a line from the eye to the target\r\n  this.bitmap.context.beginPath();\r\n  this.bitmap.context.moveTo(target.x, target.y);\r\n  this.bitmap.context.lineTo(this.eye.x, this.eye.y);\r\n  this.bitmap.context.stroke();\r\n\r\n  this.bitmap.context.beginPath();\r\n  this.bitmap.context.moveTo(target.x + target.width, target.y);\r\n  this.bitmap.context.lineTo(this.eye.x, this.eye.y);\r\n  this.bitmap.context.stroke();\r\n\r\n  this.bitmap.context.beginPath();\r\n  this.bitmap.context.moveTo(target.x, target.y + target.height);\r\n  this.bitmap.context.lineTo(this.eye.x, this.eye.y);\r\n  this.bitmap.context.stroke();\r\n\r\n  this.bitmap.context.beginPath();\r\n  this.bitmap.context.moveTo(target.x + target.width, target.y + target.height);\r\n  this.bitmap.context.lineTo(this.eye.x, this.eye.y);\r\n  this.bitmap.context.stroke();\r\n};",
    "var BasicGame = require('BasicGame');\r\n\r\n/**\r\n * Method that set the default values for the properties of the Helper object.\r\n * \r\n * @param {Object} game    The Object of Phaser game\r\n * @param {Object} gameObj The Object of BasicGame.Game\r\n */\r\nBasicGame.Helper = function (game, gameObj) {\r\n  this.game = game;\r\n  this.gameObj = gameObj;\r\n};\r\n\r\nBasicGame.Helper.prototype.timer = function (delay, callback, context) {\r\n  this.game.time.create(this.game, true)\r\n    .add(delay, callback, context || this)\r\n    .timer.start(100);\r\n};\r\n\r\nBasicGame.Helper.prototype.randomColor = function () {\r\n  var letters = '0123456789ABCDEF';\r\n  var color = '0x';\r\n  for (var i = 0; i < 6; i++ ) {\r\n    color += letters[Math.floor(Math.random() * 16)];\r\n  }\r\n  return color;\r\n};\r\n\r\nBasicGame.Helper.prototype.randomNumber = function (max, min) {\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\nBasicGame.Helper.prototype.getLevelIdAndName = function (levelNumber) {\r\n  var postfix = (levelNumber < 10) ? '0' : '';\r\n  return {\r\n    id: 'lvl' + postfix + levelNumber,\r\n    name: 'level' + postfix + levelNumber\r\n  };\r\n};\r\n\r\nBasicGame.Helper.prototype.getSkyName = function (levelNumber) {\r\n  if (levelNumber <= 10) {\r\n    return 'sky01';\r\n  } else if (levelNumber <= 20) {\r\n    return 'sky02';\r\n  } else {\r\n    return 'sky03';\r\n  }\r\n};",
    "var BasicGame = require('BasicGame');\r\n\r\n/**\r\nThe MIT License (MIT)\r\nCopyright (c) <year> <copyright holders>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n*/\r\n\r\nBasicGame.Level = function (game, gameObj) {\r\n  this.game = game;\r\n  this.gameObj = gameObj;\r\n  this.levelMusic = null;\r\n  this.walls = null;\r\n  this.ground = null;\r\n  this.map = null;\r\n  this.endTimer = null;\r\n  this.isEnded = null;\r\n  this.initPlayerPos = {x: 0, y: 0};\r\n  this.daysShown = false;\r\n  this.dayNumberTextBitmap = null;\r\n  this.dayPhraseTextBitmap = null;\r\n  this.isReady = false;\r\n  this.isShowingDays = false;\r\n  this.dayText = {\r\n    \"es\": \"Día\",\r\n    \"en\": \"Day\"\r\n  };\r\n\r\n  // font attributes\r\n  this.fontId = 'font';\r\n  this.hasFloor = false;\r\n  this.hasSpikes = false;\r\n\r\n  this.daySound = null;\r\n  this.spikeSound = null;\r\n};\r\n\r\nBasicGame.Level.prototype.create = function () {\r\n  // create the background for the day\r\n  this.levelTextGroup = this.game.add.group();\r\n  var dayTextBitmap = new Phaser.BitmapData(this.game,\r\n    'dayTextBitmap',\r\n    this.game.world.width,\r\n    this.game.world.height);\r\n  dayTextBitmap.ctx.rect(0, 0, this.game.world.width, this.game.world.height);\r\n  dayTextBitmap.ctx.fillStyle = '#FFF';\r\n  dayTextBitmap.ctx.fill();\r\n\r\n  var dayTextSprite = new Phaser.Sprite(this.game, 0, 0, dayTextBitmap);\r\n  dayTextSprite.anchor.set(0.5, 0.5);\r\n  dayTextSprite.position.set(this.game.world.width / 2, this.game.world.height / 2);\r\n  dayTextSprite.height = 200;\r\n  dayTextSprite.alpha = 0;\r\n\r\n  this.levelTextGroup.addChild(dayTextSprite);\r\n\r\n  // create the bitmap for the day number\r\n  this.dayNumberTextBitmap = this.game.add.bitmapText(this.game.world.width/2,\r\n    this.game.world.height/2 - 15,\r\n    this.fontId,\r\n    '',\r\n    72,\r\n    this.levelTextGroup);\r\n  this.dayNumberTextBitmap.anchor.set(0.5, 0.5);\r\n  this.dayNumberTextBitmap.align = \"center\";\r\n  this.dayNumberTextBitmap.tint = 0x1e3137;\r\n  this.dayNumberTextBitmap.oriY = this.dayNumberTextBitmap.y;\r\n\r\n  // create the bitmap for the day phrase\r\n  this.dayPhraseTextBitmap = this.game.add.bitmapText(0,\r\n    this.dayNumberTextBitmap.bottom + 20,\r\n    this.fontId,\r\n    '',\r\n    48,\r\n    this.levelTextGroup);\r\n  this.dayPhraseTextBitmap.maxWidth = this.game.world.width;\r\n  this.dayPhraseTextBitmap.align = \"center\";\r\n  this.dayPhraseTextBitmap.tint = 0x515151;\r\n\r\n  if (!this.daySound) {\r\n    this.daySound = this.game.add.sound('day', 0.15);\r\n  }\r\n\r\n  if (!this.spikeSound) {\r\n    this.spikeSound = this.game.add.sound('spike', 0.2);\r\n  }\r\n\r\n  this.createLevel(parseInt(BasicGame.currentLevel));\r\n};\r\n\r\nBasicGame.Level.prototype.destroyCurrentLevel = function () {\r\n  this.map.destroy();\r\n  if(this.ground) {\r\n    this.ground.destroy();\r\n  }\r\n  this.walls.destroy();\r\n  if(this.hasSpikes) {\r\n    this.spikes.forEach(function (spikeSprite) {\r\n      if (!spikeSprite || !spikeSprite.showTween || !spikeSprite.hideTween) return;\r\n      spikeSprite.showTween.stop();\r\n      spikeSprite.hideTween.stop();\r\n    });\r\n    this.spikes.destroy();\r\n  }\r\n  if(this.pieces) {\r\n    this.pieces.destroy();\r\n  }\r\n  this.dayNumberTextBitmap.setText(\"\");\r\n  this.dayPhraseTextBitmap.setText(\"\");\r\n};\r\n\r\nBasicGame.Level.prototype.createLevel = function (num) {\r\n  var _self = this;\r\n  this.map = this.game.add.tilemap('lvl' + ((num < 10) ? '0' + num : num));\r\n\r\n  // create the floor of the level\r\n  this.hasFloor = false;\r\n  if(this.map.objects.floor) {\r\n    this.hasFloor = true;\r\n    this.ground = this.game.add.group();\r\n\r\n    this.map.createFromObjects(\"floor\", \"\", 'platform', 0, true, false,\r\n      this.ground, Phaser.Sprite, false);\r\n\r\n    this.ground.enableBody = true;\r\n    this.game.physics.arcade.enable(this.ground);\r\n    this.ground.forEach(function (groundSprite) {\r\n      groundSprite.body.immovable = true;\r\n      groundSprite.body.allowGravity = false;\r\n    });\r\n  }\r\n\r\n  // create the walls of the level\r\n  this.walls = this.game.add.group();\r\n  this.map.createFromObjects(\"platforms\", \"\", 'platform', 0, true, false,\r\n    this.walls, Phaser.Sprite, false);\r\n\r\n  this.walls.enableBody = true;\r\n  this.game.physics.arcade.enable(this.walls);\r\n  this.walls.forEach(function (platformSprite) {\r\n    platformSprite.body.immovable = true;\r\n    platformSprite.body.allowGravity = false;\r\n  });\r\n\r\n  // create the spikes (and platform) of the level\r\n  this.hasSpikes = false;\r\n  if(this.map.objects.spikes) {\r\n    this.hasSpikes = true;\r\n\r\n    this.spikes = this.game.add.group();\r\n    this.spikes.openedSpikes = 0;\r\n\r\n    this.map.createFromObjects(\"spikes\", \"\", 'spike-platform', 0, true, false,\r\n      this.walls, Phaser.Sprite, false);\r\n    this.walls.forEach(function (platformSprite) {\r\n      if(platformSprite[\"spike-platform\"] == \"1\") {\r\n        var createdSpike = null;\r\n        if (platformSprite[\"spike-side\"]) {\r\n          createdSpike = _self.addHeightSpike(platformSprite, platformSprite[\"spike-side\"]);\r\n        }\r\n        else {\r\n          createdSpike = _self.addWidthSpike(platformSprite, platformSprite[\"spike-down\"]);\r\n        }\r\n\r\n        // add a reference to the spikes in the platform to they belong which\r\n        platformSprite.spikeRef = createdSpike;\r\n        platformSprite.body.immovable = true;\r\n        platformSprite.body.allowGravity = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  // create the pieces of the level\r\n  this.pieces = this.game.add.group();\r\n  this.map.createFromObjects(\"pieces\", \"\", 'piece', null, true, false,\r\n    this.pieces, Phaser.Sprite, false);\r\n\r\n  this.pieces.forEach(function (pieceSprite) {\r\n    pieceSprite.anchor.set(0.5, 0.5);\r\n    _self.game.physics.arcade.enableBody(pieceSprite);\r\n    pieceSprite.body.allowGravity = false;\r\n    pieceSprite.body.immovable = false;\r\n    pieceSprite.body.friction = new Phaser.Point(0, 0);\r\n  });\r\n\r\n  // get the player initial position\r\n  if(this.map.objects.player_pos) {\r\n    this.initPlayerPos.x = this.map.objects.player_pos[0].x;\r\n    this.initPlayerPos.y = this.map.objects.player_pos[0].y;\r\n  }\r\n\r\n  this.game.world.bringToTop(this.levelTextGroup);\r\n\r\n  // show the days of the level\r\n  var dayObj = this.gameObj.days.getDay(BasicGame.currentLevel);\r\n  this.dayNumberTextBitmap.setText(this.dayText[BasicGame.language] + ' ' + dayObj.number);\r\n  this.dayNumberTextBitmap.y = this.dayNumberTextBitmap.oriY;\r\n  if(dayObj.text) {\r\n    this.dayPhraseTextBitmap.setText(dayObj.text[BasicGame.language]);\r\n    this.dayPhraseTextBitmap.x = this.game.world.width/2 - this.dayPhraseTextBitmap.width/2;\r\n  }\r\n  else {\r\n    this.dayNumberTextBitmap.y += 15;\r\n  }\r\n\r\n  // set the level as not ended\r\n  this.isEnded = false;\r\n\r\n  // TODO: remove this property\r\n  this.isReady = true;\r\n};\r\n\r\nBasicGame.Level.prototype.render = function () {\r\n  if(BasicGame.Game.developmentMode === true) {\r\n    var _self = this;\r\n    this.spikes.forEach(function (pieceSprite) {\r\n      _self.game.debug.body(pieceSprite, 'rgba(0,0,255,0.8)');\r\n    });\r\n  }\r\n};\r\n\r\nBasicGame.Level.prototype.endLevel = function () {\r\n  BasicGame.isRetrying = false;\r\n  var secondsToEnd = this.gameObj.countdownDuration;\r\n\r\n  // create the timer\r\n  this.endTimer = this.game.time.create(true);\r\n\r\n  // starts the timer that will end the level\r\n  this.endTimer.add(secondsToEnd * 1000,\r\n    function () {\r\n      // enable the flag that indicates the other objects the level is finished\r\n      this.endTimer = undefined;\r\n      this.isEnded = true;\r\n\r\n      this.gameObj.levelEnded();\r\n    },\r\n    this);\r\n\r\n  this.endTimer.start();\r\n  this.gameObj.showDarkness();\r\n};\r\n\r\nBasicGame.Level.prototype.showDay = function () {\r\n  if(this.isShowingDays === true) {\r\n    return;\r\n  }\r\n\r\n  this.isShowingDays = true;\r\n\r\n  this.levelTextGroup.getChildAt(0).alpha = 1;\r\n  this.levelTextGroup.alpha = 1;\r\n\r\n  this.game.world.bringToTop(this.levelTextGroup);\r\n\r\n  this.daySound.play();\r\n\r\n  // create the timer\r\n  var dayTimer = this.game.time.create(true);\r\n\r\n  // set the timer to stop showing the day\r\n  var currentDayObj = this.gameObj.days.getDay(BasicGame.currentLevel);\r\n  dayTimer.add((currentDayObj.waitTime || 2) * 1000,\r\n    function () {\r\n      this.levelTextGroup.alpha = 0;\r\n      this.isShowingDays = false;\r\n      this.gameObj.hideDarkness();\r\n    },\r\n    this);\r\n\r\n  dayTimer.start();\r\n};\r\n\r\nBasicGame.Level.prototype.addWidthSpike = function (platformSprite, inBottom) {\r\n  // add the spikes to the platform\r\n  var spikeSprite = null;\r\n\r\n  if(!inBottom) {\r\n    spikeSprite = this.game.add.tileSprite(platformSprite.x,\r\n      platformSprite.y + 5,\r\n      platformSprite.width, 16, \"spike\", 0, this.spikes);\r\n    spikeSprite.isHidden = true;\r\n    spikeSprite.oriY = spikeSprite.y;\r\n    spikeSprite.desY = platformSprite.y -16;\r\n    this.spikes.openedSpikes++;\r\n  }\r\n  else {\r\n    spikeSprite = this.game.add.tileSprite(platformSprite.x,\r\n      platformSprite.bottom,\r\n      platformSprite.width, 16, \"spike-d\", 0, this.spikes);\r\n    spikeSprite.isHidden = false;\r\n    // spikeSprite.oriY = spikeSprite.y;\r\n    // spikeSprite.desY = platformSprite.y -16;\r\n  }\r\n\r\n  if(!inBottom) {\r\n    // create the tweens for showing and hiding the spikes\r\n    var showSpikeTween = this.createShowSpikeTween(spikeSprite,\r\n      {y: spikeSprite.desY}, 100, 300);\r\n\r\n    var hideSpikeTween = this.game.add.tween(spikeSprite)\r\n    .to({y: spikeSprite.oriY},\r\n      300,\r\n      Phaser.Easing.Exponential.Out,\r\n      false,\r\n      1000);\r\n    hideSpikeTween.onComplete.add(function () {\r\n      this.isHidden = true;\r\n      this.parent.openedSpikes--;\r\n    }, spikeSprite);\r\n\r\n    spikeSprite.showTween = showSpikeTween;\r\n    spikeSprite.hideTween = hideSpikeTween;\r\n  }\r\n\r\n  // set physics properties for the spikes\r\n  this.game.physics.arcade.enable(spikeSprite);\r\n  spikeSprite.body.immovable = true;\r\n  spikeSprite.body.allowGravity = false;\r\n\r\n\r\n  var numofspikes = platformSprite.width / 32;\r\n  spikeSprite.body.width = platformSprite.width * (numofspikes / (numofspikes + 0.5));\r\n  spikeSprite.body.height = 8;\r\n  spikeSprite.body.offset.x = (platformSprite.width / 2) - (spikeSprite.body.width / 2);\r\n  \r\n  if(!inBottom)\r\n    spikeSprite.body.offset.y = 8;\r\n  else\r\n    spikeSprite.body.offset.y = 0;\r\n\r\n  return spikeSprite;\r\n};\r\n\r\nBasicGame.Level.prototype.addHeightSpike = function (platformSprite, side) {\r\n  // add the spikes to the platform\r\n  var spikeSprite = null;\r\n  if (side === 'r') {\r\n    spikeSprite = this.game.add.tileSprite(platformSprite.right - 21,\r\n      platformSprite.y,\r\n      16, platformSprite.height,\r\n      \"spike-r\", 0, this.spikes);\r\n    spikeSprite.isHidden = true;\r\n    spikeSprite.oriX = spikeSprite.x;\r\n    spikeSprite.desX = platformSprite.right;\r\n  }\r\n  else if(side === 'l') {\r\n    spikeSprite = this.game.add.tileSprite(platformSprite.x + 5,\r\n      platformSprite.top,\r\n      16, platformSprite.height,\r\n      \"spike-l\", 0, this.spikes);\r\n    spikeSprite.isHidden = true;\r\n    spikeSprite.oriX = spikeSprite.x;\r\n    spikeSprite.desX = platformSprite.x - 16;\r\n  } else {\r\n    return null;\r\n  }\r\n\r\n  // create the tweens for showing and hiding the spikes\r\n  var showSpikeTween = this.createShowSpikeTween(spikeSprite,\r\n    {x: spikeSprite.desX}, 100, 500);\r\n\r\n  var hideSpikeTween = this.game.add.tween(spikeSprite)\r\n  .to({x: spikeSprite.oriX},\r\n    300,\r\n    Phaser.Easing.Exponential.Out,\r\n    false,\r\n    1000);\r\n  hideSpikeTween.onComplete.add(function () {\r\n    this.isHidden = true;\r\n    this.parent.openedSpikes--;\r\n  }, spikeSprite);\r\n\r\n  spikeSprite.showTween = showSpikeTween;\r\n  spikeSprite.hideTween = hideSpikeTween;\r\n\r\n  // set physics properties for the spikes\r\n  this.game.physics.arcade.enable(spikeSprite);\r\n  spikeSprite.body.immovable = true;\r\n  spikeSprite.body.allowGravity = false;\r\n\r\n  var numofspikes = platformSprite.height / 32;\r\n  spikeSprite.body.width = 8;\r\n  spikeSprite.body.height = platformSprite.height * (numofspikes / (numofspikes + 0.5));\r\n  spikeSprite.body.offset.y = (platformSprite.height / 2) - (spikeSprite.body.height / 2);\r\n  \r\n  if (side === 'r')\r\n    spikeSprite.body.offset.x = 0;\r\n  else\r\n    spikeSprite.body.offset.x = 8;\r\n\r\n  return spikeSprite;\r\n};\r\n\r\nBasicGame.Level.prototype.createShowSpikeTween = function (spikeSprite, properties, duration, delay) {\r\n  var _self = this;\r\n  var showSpikeTween = this.game.add.tween(spikeSprite)\r\n  .to(properties,\r\n    duration,\r\n    null,\r\n    false,\r\n    delay);\r\n\r\n  showSpikeTween.onComplete.add(function () {\r\n    this.isHidden = false;\r\n    this.hideTween.start();\r\n    this.parent.openedSpikes++;\r\n  }, spikeSprite);\r\n\r\n  return showSpikeTween;\r\n};\r\n\r\nBasicGame.Level.prototype.restartLevel = function () {\r\n  // enable the body physics for each piece and make it visible\r\n  this.pieces.forEach(function (pieceSprite) {\r\n    pieceSprite.alpha = 1;\r\n    pieceSprite.body.enable = true;\r\n  });\r\n};",
    "var BasicGame = require('BasicGame');\r\n\r\n/**\r\nThe MIT License (MIT)\r\nCopyright (c) <year> <copyright holders>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n\r\nBasicGame.Light = function (game, gameObj) {\r\n  this.game = game;\r\n  this.gameObj = gameObj;\r\n  this.lightGroup = null;\r\n  this.light = null;\r\n  this.bitmap = null;\r\n  this.rayBitmap = null;\r\n  this.rayBitmapImage = null;\r\n  this.walls = null;\r\n  this.level = null;\r\n  this.shadowsDrawn = null;\r\n};\r\n\r\nBasicGame.Light.prototype.create = function (level) {\r\n  this.level = level;\r\n  this.walls = this.level.walls;\r\n  this.shadowsDrawn = false;\r\n\r\n  var light = null;\r\n\r\n  //Add the light(s)\r\n  this.lightGroup = this.game.add.group();\r\n  light = this.game.add.sprite((this.game.world.width / 2), -16, 'light');\r\n  // light = this.game.add.sprite((this.game.world.width / 2) - 16, -16, 'light');\r\n  light.alpha = 0;\r\n\r\n  // Set the pivot point of the light to the center of the texture\r\n  light.anchor.setTo(0.5, 0.5);\r\n\r\n  //Add the light to the array of lights\r\n  this.lightGroup.add(light);\r\n\r\n  // Create a bitmap texture for drawing light cones\r\n  this.bitmap = this.game.add.bitmapData(this.game.world.width, this.game.height);\r\n  this.bitmap.context.fillStyle = 'rgb(255, 255, 255)';\r\n  this.bitmap.context.strokeStyle = 'rgb(255, 255, 255)';\r\n  this.lightBitmap = this.game.add.image(0, 0, this.bitmap);\r\n\r\n  // This bitmap is drawn onto the screen using the MULTIPLY blend mode.\r\n  // Since this bitmap is over the background, dark areas of the bitmap\r\n  // will make the background darker. White areas of the bitmap will allow\r\n  // the normal colors of the background to show through. Blend modes are\r\n  // only supported in WebGL. If your browser doesn't support WebGL then\r\n  // you'll see gray shadows and white light instead of colors and it\r\n  // generally won't look nearly as cool. So use a browser with WebGL.\r\n  this.lightBitmap.blendMode = Phaser.blendModes.MULTIPLY;\r\n\r\n  // Create a bitmap for drawing rays\r\n  this.rayBitmap = this.game.add.bitmapData(this.game.world.width, this.game.height);\r\n  this.rayBitmapImage = this.game.add.image(0, 0, this.rayBitmap);\r\n  this.rayBitmapImage.visible = false;\r\n};\r\n\r\nBasicGame.Light.prototype.drawShadows = function () {\r\n  // Move the light to the pointer/touch location\r\n  this.rayBitmapImage.visible = BasicGame.Game.developmentMode || false;\r\n\r\n  if(this.gameObj.inDarkness == true){\r\n    return;\r\n  }\r\n\r\n  // Next, fill the entire light bitmap with a dark shadow color.\r\n  this.bitmap.context.fillStyle = 'rgb(81, 81, 81)';\r\n  this.bitmap.context.fillRect(0, 0, this.game.world.width, this.game.height);\r\n\r\n  // An array of the stage corners that we'll use later\r\n  var stageCorners = [\r\n    new Phaser.Point(0, 0),\r\n    new Phaser.Point(this.game.world.width, 0),\r\n    new Phaser.Point(this.game.world.width, this.game.height),\r\n    new Phaser.Point(0, this.game.height)\r\n  ];\r\n\r\n  // Ray casting!\r\n  // Cast rays from each light\r\n  this.lightGroup.forEach(function (light) {\r\n    // Cast rays through the corners of each wall towards the stage edge.\r\n    // Save all of the intersection points or ray end points if there was no intersection.\r\n    var points = [];\r\n    var ray = null;\r\n    var intersect;\r\n    var i;\r\n\r\n    this.walls.forEach(function (wall) {\r\n      // Create a ray from the light through each corner out to the edge of the stage.\r\n      // This array defines points just inside of each corner to make sure we hit each one.\r\n      // It also defines points just outside of each corner so we can see to the stage edges.\r\n      var corners = [\r\n        new Phaser.Point(wall.x + 0.1, wall.y + 0.1),\r\n        new Phaser.Point(wall.x - 0.1, wall.y - 0.1),\r\n\r\n        new Phaser.Point(wall.x - 0.1 + wall.width, wall.y + 0.1),\r\n        new Phaser.Point(wall.x + 0.1 + wall.width, wall.y - 0.1),\r\n\r\n        new Phaser.Point(wall.x - 0.1 + wall.width, wall.y - 0.1 + wall.height),\r\n        new Phaser.Point(wall.x + 0.1 + wall.width, wall.y + 0.1 + wall.height),\r\n\r\n        new Phaser.Point(wall.x + 0.1, wall.y - 0.1 + wall.height),\r\n        new Phaser.Point(wall.x - 0.1, wall.y + 0.1 + wall.height)\r\n      ];\r\n\r\n      // Calculate rays through each point to the edge of the stage\r\n      for (i = 0; i < corners.length; i++) {\r\n        var c = corners[i];\r\n\r\n        // Here comes the linear algebra.\r\n        // The equation for a line is y = slope * x + b\r\n        // b is where the line crosses the left edge of the stage\r\n        var slope = (c.y - light.y) / (c.x - light.x);\r\n        var b = light.y - slope * light.x;\r\n\r\n        var end = null;\r\n\r\n        if (c.x === light.x) {\r\n          // Vertical lines are a special case\r\n          if (c.y <= light.y) {\r\n            end = new Phaser.Point(light.x, 0);\r\n          } else {\r\n            end = new Phaser.Point(light.x, this.game.height);\r\n          }\r\n        } else if (c.y === light.y) {\r\n          // Horizontal lines are a special case\r\n          if (c.x <= light.x) {\r\n            end = new Phaser.Point(0, light.y);\r\n          } else {\r\n            end = new Phaser.Point(this.game.world.width, light.y);\r\n          }\r\n        } else {\r\n          // Find the point where the line crosses the stage edge\r\n          var left = new Phaser.Point(0, b);\r\n          var right = new Phaser.Point(this.game.world.width, slope * this.game.world.width + b);\r\n          var top = new Phaser.Point(-b / slope, 0);\r\n          var bottom = new Phaser.Point((this.game.height - b) / slope, this.game.height);\r\n\r\n          // Get the actual intersection point\r\n          if (c.y <= light.y && c.x >= light.x) {\r\n            if (top.x >= 0 && top.x <= this.game.world.width) {\r\n              end = top;\r\n            } else {\r\n              end = right;\r\n            }\r\n          } else if (c.y <= light.y && c.x <= light.x) {\r\n            if (top.x >= 0 && top.x <= this.game.world.width) {\r\n              end = top;\r\n            } else {\r\n              end = left;\r\n            }\r\n          } else if (c.y >= light.y && c.x >= light.x) {\r\n            if (bottom.x >= 0 && bottom.x <= this.game.world.width) {\r\n              end = bottom;\r\n            } else {\r\n              end = right;\r\n            }\r\n          } else if (c.y >= light.y && c.x <= light.x) {\r\n            if (bottom.x >= 0 && bottom.x <= this.game.world.width) {\r\n              end = bottom;\r\n            } else {\r\n              end = left;\r\n            }\r\n          }\r\n        }\r\n\r\n        // Create a ray\r\n        ray = new Phaser.Line(light.x, light.y, end.x, end.y);\r\n\r\n        // Check if the ray intersected the wall\r\n        intersect = this.getWallIntersection(ray);\r\n        if (intersect) {\r\n          // This is the front edge of the light blocking object\r\n          points.push(intersect);\r\n        } else {\r\n          // Nothing blocked the ray\r\n          points.push(ray.end);\r\n        }\r\n      }\r\n    }, this);\r\n\r\n    // Shoot rays at each of the stage corners to see if the corner\r\n    // of the stage is in shadow. This needs to be done so that\r\n    // shadows don't cut the corner.\r\n    for (i = 0; i < stageCorners.length; i++) {\r\n      ray = new Phaser.Line(light.x, light.y,\r\n        stageCorners[i].x, stageCorners[i].y);\r\n      intersect = this.getWallIntersection(ray);\r\n      if (!intersect) {\r\n        // Corner is in light\r\n        points.push(stageCorners[i]);\r\n      }\r\n    }\r\n\r\n    // Now sort the points clockwise around the light\r\n    // Sorting is required so that the points are connected in the right order.\r\n    //\r\n    // This sorting algorithm was copied from Stack Overflow:\r\n    // http://stackoverflow.com/questions/6989100/sort-points-in-clockwise-order\r\n    //\r\n    // Here's a pseudo-code implementation if you want to code it yourself:\r\n    // http://en.wikipedia.org/wiki/Graham_scan\r\n    var center = {x: light.x, y: light.y};\r\n    points = points.sort(function (a, b) {\r\n      if (a.x - center.x >= 0 && b.x - center.x < 0)\r\n        return 1;\r\n      if (a.x - center.x < 0 && b.x - center.x >= 0)\r\n        return -1;\r\n      if (a.x - center.x === 0 && b.x - center.x === 0) {\r\n        if (a.y - center.y >= 0 || b.y - center.y >= 0)\r\n          return 1;\r\n        return -1;\r\n      }\r\n\r\n      // Compute the cross product of vectors (center -> a) x (center -> b)\r\n      var det = (a.x - center.x) * (b.y - center.y) - (b.x - center.x) * (a.y - center.y);\r\n      if (det < 0)\r\n        return 1;\r\n      if (det > 0)\r\n        return -1;\r\n\r\n      // Points a and b are on the same line from the center\r\n      // Check which point is closer to the center\r\n      var d1 = (a.x - center.x) * (a.x - center.x) + (a.y - center.y) * (a.y - center.y);\r\n      var d2 = (b.x - center.x) * (b.x - center.x) + (b.y - center.y) * (b.y - center.y);\r\n      return 1;\r\n    });\r\n\r\n    // Connect the dots and fill in the shape, which are cones of light,\r\n    // with a bright white color. When multiplied with the background,\r\n    // the white color will allow the full color of the background to\r\n    // shine through.\r\n    this.bitmap.context.beginPath();\r\n    this.bitmap.context.fillStyle = 'rgb(255, 255, 255)';\r\n    this.bitmap.context.moveTo(points[0].x, points[0].y);\r\n    for (var j = 0; j < points.length; j++) {\r\n      this.bitmap.context.lineTo(points[j].x, points[j].y);\r\n    }\r\n    this.bitmap.context.closePath();\r\n    this.bitmap.context.fill();\r\n\r\n    if(BasicGame.Game.developmentMode){\r\n      // Draw each of the rays on the rayBitmap\r\n      this.rayBitmap.context.clearRect(0, 0, this.game.world.width, this.game.height);\r\n      this.rayBitmap.context.beginPath();\r\n      this.rayBitmap.context.strokeStyle = 'rgb(255, 255, 255)';\r\n      this.rayBitmap.context.fillStyle = 'rgb(255, 255, 255)';\r\n      this.rayBitmap.context.moveTo(points[0].x, points[0].y);\r\n      for (var k = 0; k < points.length; k++) {\r\n        this.rayBitmap.context.moveTo(light.x, light.y);\r\n        this.rayBitmap.context.lineTo(points[k].x, points[k].y);\r\n        this.rayBitmap.context.fillRect(points[k].x - 2, points[k].y - 2, 4, 4);\r\n      }\r\n      this.rayBitmap.context.stroke();\r\n    }\r\n\r\n  }, this);\r\n\r\n  // This just tells the engine it should update the texture cache\r\n  this.bitmap.dirty = true;\r\n  if(BasicGame.Game.developmentMode){\r\n    this.rayBitmap.dirty = true;\r\n  }\r\n\r\n  this.shadowsDrawn = true;\r\n};\r\n\r\nBasicGame.Light.prototype.update = function(){\r\n  if(this.shadowsDrawn === false){\r\n    this.drawShadows();\r\n  }\r\n  // draw shadows if light is moving in the level\r\n};\r\n\r\n// Given a ray, this function iterates through all of the walls and\r\n// returns the closest wall intersection from the start of the ray\r\n// or null if the ray does not intersect any walls.\r\nBasicGame.Light.prototype.getWallIntersection = function (ray) {\r\n  var distanceToWall = Number.POSITIVE_INFINITY;\r\n  var closestIntersection = null;\r\n\r\n  // For each of the walls...\r\n  this.walls.forEach(function (wall) {\r\n    // Create an array of lines that represent the four edges of each wall\r\n    var lines = [\r\n      new Phaser.Line(wall.x, wall.y, wall.x + wall.width, wall.y),\r\n      new Phaser.Line(wall.x, wall.y, wall.x, wall.y + wall.height),\r\n      new Phaser.Line(wall.x + wall.width, wall.y,\r\n        wall.x + wall.width, wall.y + wall.height),\r\n      new Phaser.Line(wall.x, wall.y + wall.height,\r\n        wall.x + wall.width, wall.y + wall.height)\r\n    ];\r\n\r\n    // Test each of the edges in this wall against the ray.\r\n    // If the ray intersects any of the edges then the wall must be in the way.\r\n    for (var i = 0; i < lines.length; i++) {\r\n      var intersect = Phaser.Line.intersects(ray, lines[i]);\r\n      if (intersect) {\r\n        // Find the closest intersection\r\n        distance =\r\n          this.game.math.distance(ray.start.x, ray.start.y, intersect.x, intersect.y);\r\n        if (distance < distanceToWall) {\r\n          distanceToWall = distance;\r\n          closestIntersection = intersect;\r\n        }\r\n      }\r\n    }\r\n  }, this);\r\n\r\n  return closestIntersection;\r\n};\r\n\r\nBasicGame.Light.prototype.destroyCurrentWalls = function (walls) {\r\n};\r\n\r\nBasicGame.Light.prototype.updateWalls = function (level) {\r\n  this.walls = level.walls;\r\n  this.shadowsDrawn = false;\r\n};",
    "var BasicGame = require('BasicGame');\r\n\r\n/**\r\nThe MIT License (MIT)\r\nCopyright (c) <year> <copyright holders>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n\r\nBasicGame.Lightning = function (game, gameObj){\r\n  this.game = game;\r\n  this.gameObj = gameObj;\r\n  this.lightningBitmap = null;\r\n  this.lightning = null;\r\n  this.player = null;\r\n  this.eye = null;\r\n  this.level = null;\r\n\r\n  this.lightningSound = null;\r\n};\r\n\r\nBasicGame.Lightning.prototype.create = function(eye, player, level){\r\n  this.player = player;\r\n  this.eye = eye;\r\n  this.level = level;\r\n\r\n  // Create a bitmap for the lightning bolt texture\r\n  this.lightningBitmap = this.game.add.bitmapData(200, 10000);\r\n\r\n  // Create a sprite to hold the lightning bolt texture\r\n  this.lightning = this.game.add.image(this.eye.x,\r\n    this.eye.y,\r\n    this.lightningBitmap);\r\n  this.lightning.anchor.setTo(0.5, 0);\r\n\r\n  this.fakeThing = this.game.add.sprite(-10, -10, \"player\");\r\n  this.fakeThing.anchor.setTo(0.5, 0.5);\r\n  this.fakeThing.width = this.fakeThing.height = 16;\r\n  this.fakeThing.alpha = 0;\r\n  \r\n  // this.game.physics.arcade.enable(this.fakeThing);\r\n  // this.fakeThing.body.immovable = true;\r\n  // this.fakeThing.body.allowGravity = false;\r\n\r\n  this.lightningTimer = 0;\r\n\r\n  if (!this.lightningSound) {\r\n    this.lightningSound = this.game.add.sound('ray', 0.2);\r\n  }\r\n};\r\n\r\nBasicGame.Lightning.prototype.update = function () {\r\n  // check if the ray hits the player\r\n  if (this.player.player && this.fakeThing)\r\n  {\r\n    if (this.fakeThing.left > this.player.player.left &&\r\n        this.fakeThing.right < this.player.player.right &&\r\n        this.fakeThing.top > this.player.player.top &&\r\n        this.fakeThing.bottom < this.player.player.bottom)\r\n    {\r\n      this.gameObj.subtractLife();\r\n      this.gameObj.shakeCamera();\r\n    }\r\n    this.fakeThing.x = this.fakeThing.y = -10;\r\n  }\r\n};\r\n\r\nBasicGame.Lightning.prototype.shoot = function (target) {\r\n  this.fakeThing.x = this.fakeThing.y = 0;\r\n  var targetPos = {\r\n    x: target.x,\r\n    y: target.y\r\n  };\r\n\r\n  // Rotate the lightning sprite so it goes in the\r\n  // direction of the pointer\r\n  this.lightning.rotation = this.game.math.angleBetween(\r\n    this.lightning.x, this.lightning.y,\r\n    targetPos.x + 16, targetPos.y + 16\r\n  ) - Math.PI / 2;\r\n\r\n  // Calculate the distance from the lightning source to the pointer\r\n  var distance = this.game.math.distance(\r\n    this.lightning.x, this.lightning.y,\r\n    targetPos.x + 16, targetPos.y + 16\r\n  );\r\n\r\n  // Create the lightning texture\r\n  this.createLightningTexture(this.lightningBitmap.width / 2, 0, 20, 2, false, distance);\r\n\r\n  // Make the lightning sprite visible\r\n  this.lightning.alpha = 1;\r\n\r\n  // Fade out the lightning sprite using a tween on the alpha property\r\n  // Check out the \"Easing function\" examples for more info.\r\n  this.game.add.tween(this.lightning)\r\n    .to({alpha: 0.5}, 100, Phaser.Easing.Bounce.Out)\r\n    .to({alpha: 1.0}, 100, Phaser.Easing.Bounce.Out)\r\n    .to({alpha: 0.5}, 100, Phaser.Easing.Bounce.Out)\r\n    .to({alpha: 1.0}, 100, Phaser.Easing.Bounce.Out)\r\n    .to({alpha: 0}, 250, Phaser.Easing.Cubic.In)\r\n    .start();\r\n\r\n  this.fakeThing.x = targetPos.x + 16;\r\n  this.fakeThing.y = targetPos.y + 16;\r\n\r\n  this.lightningSound.play();\r\n};\r\n\r\n// This function creates a texture that looks like a lightning bolt\r\nBasicGame.Lightning.prototype.createLightningTexture = function (x, y, segments, boltWidth, branch, distance) {\r\n  // Get the canvas drawing context for the lightningBitmap\r\n  var ctx = this.lightningBitmap.context;\r\n  var width = this.lightningBitmap.width;\r\n  var height = this.lightningBitmap.height;\r\n\r\n  // Our lightning will be made up of several line segments starting at\r\n  // the center of the top edge of the bitmap and ending at the target.\r\n\r\n  // Clear the canvas\r\n  if (!branch) ctx.clearRect(0, 0, width, height);\r\n\r\n  // Draw each of the segments\r\n  for (var i = 0; i < segments; i++) {\r\n    // Set the lightning color and bolt width\r\n    ctx.strokeStyle = 'rgb(255, 255, 255)';\r\n    ctx.lineWidth = boltWidth;\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(x, y);\r\n\r\n    // Calculate an x offset from the end of the last line segment and\r\n    // keep it within the bounds of the bitmap\r\n    if (branch) {\r\n      // For a branch\r\n      x += this.game.rnd.integerInRange(-10, 10);\r\n    } else {\r\n      // For the main bolt\r\n      x += this.game.rnd.integerInRange(-30, 30);\r\n    }\r\n    if (x <= 10) x = 10;\r\n    if (x >= width - 10) x = width - 10;\r\n\r\n    // Calculate a y offset from the end of the last line segment.\r\n    // When we've reached the target or there are no more segments left,\r\n    // set the y position to the distance to the target. For branches, we\r\n    // don't care if they reach the target so don't set the last coordinate\r\n    // to the target if it's hanging in the air.\r\n    if (branch) {\r\n      // For a branch\r\n      y += this.game.rnd.integerInRange(10, 20);\r\n    } else {\r\n      // For the main bolt\r\n      y += this.game.rnd.integerInRange(20, distance / segments);\r\n    }\r\n    if ((!branch && i == segments - 1) || y > distance) {\r\n      // This causes the bolt to always terminate at the center\r\n      // lightning bolt bounding box at the correct distance to\r\n      // the target. Because of the way the lightning sprite is\r\n      // rotated, this causes this point to be exactly where the\r\n      // player clicked or tapped.\r\n      y = distance;\r\n      if (!branch) x = width / 2;\r\n    }\r\n\r\n    // draw the line segment\r\n    ctx.lineTo(x, y);\r\n    ctx.stroke();\r\n\r\n    // quit when we've reached the target\r\n    if (y >= distance) break;\r\n\r\n  }\r\n\r\n  // This just tells the engine it should update the texture cache\r\n  this.lightningBitmap.dirty = true;\r\n};\r\n\r\nBasicGame.Lightning.prototype.updateLevel = function (level) {\r\n  this.level = level;\r\n};\r\n\r\n/*\r\n// Fragment shaders are small programs that run on the graphics card and alter\r\n// the pixels of a texture. Every framework implements shaders differently but\r\n// the concept is the same. This shader takes the lightning texture and alters\r\n// the pixels so that it appears to be glowing. Shader programming itself is\r\n// beyond the scope of this tutorial.\r\n//\r\n// There are a ton of good resources out there to learn it. Odds are that your\r\n// framework already includes many of the most popular shaders out of the box.\r\n//\r\n// This is an OpenGL/WebGL feature. Because it runs in your web browser\r\n// you need a browser that support WebGL for this to work.\r\nPhaser.Filter.Glow = function (game) {\r\n  Phaser.Filter.call(this, game);\r\n\r\n  this.fragmentSrc = [\r\n    \"precision lowp float;\",\r\n    \"varying vec2 vTextureCoord;\",\r\n    \"varying vec4 vColor;\",\r\n    'uniform sampler2D uSampler;',\r\n\r\n    'void main() {',\r\n    'vec4 sum = vec4(0);',\r\n    'vec2 texcoord = vTextureCoord;',\r\n    'for(int xx = -4; xx <= 4; xx++) {',\r\n    'for(int yy = -3; yy <= 3; yy++) {',\r\n    'float dist = sqrt(float(xx*xx) + float(yy*yy));',\r\n    'float factor = 0.0;',\r\n    'if (dist == 0.0) {',\r\n    'factor = 2.0;',\r\n    '} else {',\r\n    'factor = 2.0/abs(float(dist));',\r\n    '}',\r\n    'sum += texture2D(uSampler, texcoord + vec2(xx, yy) * 0.002) * factor;',\r\n    '}',\r\n    '}',\r\n    'gl_FragColor = sum * 0.025 + texture2D(uSampler, texcoord);',\r\n    '}'\r\n  ];\r\n};\r\n\r\nPhaser.Filter.Glow.prototype = Object.create(Phaser.Filter.prototype);\r\nPhaser.Filter.Glow.prototype.constructor = Phaser.Filter.Glow;\r\n*/",
    "var BasicGame = require('BasicGame');\r\n\r\n/**\r\nThe MIT License (MIT)\r\nCopyright (c) <year> <copyright holders>\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n*/\r\n\r\nBasicGame.Player = function (game, input, gameObj) {\r\n  this.game = game;\r\n  this.input = input;\r\n  this.gameObj = gameObj;\r\n  this.player = null;\r\n  this.level = null;\r\n  this.bitmap = null;\r\n  this.collectedPieces = 0;\r\n  this.jumpPressed = false;\r\n  this.currentJumpMultiplier = 0;\r\n  this.jumpChance = false;\r\n  this.walkInAirTimer = null;\r\n\r\n  // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n  // define movement constants\r\n  // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n\r\n  // speed of movement in X axis\r\n  this.MAX_SPEED = 300;\r\n\r\n  // base speed of movement in X axis when an arrow key (left, right) is pressed\r\n  // in ground\r\n  this.ACCELERATION = 2500;\r\n\r\n  // base speed of movement in X axis when an arrow key (left, right) is pressed\r\n  // while jumping from a wall\r\n  this.ACCELERATION_WALL = 12000;\r\n  \r\n  // pixels per second used in character falls\r\n  this.GRAVITY = 2600;\r\n  \r\n  // base speed used to make the character jump\r\n  this.JUMP_SPEED = -850;\r\n\r\n  // base speed used to make the character jump while is against a wall\r\n  this.JUMP_SPEED_WALL = -850;\r\n\r\n\r\n  this.SLID_SPEED = 1;\r\n  this.JUMP_TIME = 150;\r\n  this.JUMP_MULTIPLIER_AMOUNT = 0.01;\r\n  this.JUMP_MULTIPLIER_MAX = 0.23;\r\n  this.JUMP_MULTIPLIER = 0.3;\r\n\r\n  // define gameplay keys\r\n  this.leftKey = Phaser.Keyboard.LEFT;\r\n  this.rightKey = Phaser.Keyboard.RIGHT;\r\n  this.jumpKey = Phaser.Keyboard.Z;\r\n\r\n  this.justLeaveGround = false;\r\n\r\n  this.jumpSound = null;\r\n  this.walkSound = null;\r\n  this.slideSound = null;\r\n  this.fallSound = null;\r\n  this.deathSound = null;\r\n  // this.piecesSound = [];\r\n  this.pieceSound = null;\r\n\r\n  this.jumpCount = 0;\r\n  this.dead = false;\r\n\r\n  this.leftFirstPress = false;\r\n  this.rightFirstPress = false;\r\n\r\n  this.particlesGroup = null;\r\n  this.PARTICLES_AMOUNT = 4;\r\n};\r\n\r\nBasicGame.Player.prototype.create = function (level) {\r\n  var particle = null,\r\n      particleX = null,\r\n      particleY = null,\r\n      increaseAmount = null;\r\n\r\n  //Save the walls in the level\r\n  this.level = level;\r\n\r\n  //Put the player in the game's world\r\n  this.player = this.game.add.sprite(this.level.initPlayerPos.x,\r\n    this.level.initPlayerPos.y,\r\n    'player');\r\n\r\n  // configure the player animations\r\n  this.player.animations.add('normal', [0], 1, false);\r\n  this.player.animations.add('dying', null, 70, false);\r\n\r\n  //Enable physics on the player\r\n  this.game.physics.arcade.enable(this.player);\r\n\r\n  //Set player minimum and maximum movement speed\r\n  this.player.body.maxVelocity.setTo(this.MAX_SPEED, this.MAX_SPEED * 20); // x, y\r\n\r\n  //Since we're jumping we need gravity\r\n  this.game.physics.arcade.gravity.y = this.GRAVITY;\r\n\r\n  //Capture certain keys to prevent their default actions in the browser.\r\n  //This is only necessary because this is an HTML5 game. Games on other\r\n  //platforms may not need code like this.\r\n  this.game.input.keyboard.addKeyCapture([\r\n    this.leftKey,\r\n    this.rightKey,\r\n    this.jumpKey\r\n    ]);\r\n\r\n  // disable physics in the player's body while the game starts\r\n  this.player.body.enable = false;\r\n\r\n  // create a bitmap texture for drawing lines\r\n  if (BasicGame.Game.developmentMode === true) { // [ development mode ]\r\n    this.bitmap = this.game.add.bitmapData(this.game.width, this.game.height);\r\n    this.bitmap.context.fillStyle = 'rgb(0, 0, 255)';\r\n    this.bitmap.context.strokeStyle = 'rgb(0, 0, 255)';\r\n    this.game.add.image(0, 0, this.bitmap);\r\n  }\r\n\r\n  if (!this.jumpSound) {\r\n    this.jumpSound = this.game.add.sound('jump', 0.2);\r\n    this.jumpSound.onPlay.add(function() {\r\n      this.slideSound.stop();\r\n    }, this);\r\n  }\r\n\r\n  if (!this.walkSound) {\r\n    this.walkSound = this.game.add.sound('walk', 0.1);\r\n    this.walkSound.onPlay.add(function() {\r\n      this.slideSound.stop();\r\n    }, this);\r\n    this.walkSound.onStop.add(function() {\r\n      if (this.onTheGround === true) {\r\n        this.slideSound.play();\r\n      }\r\n    }, this);\r\n  }\r\n\r\n  if (!this.slideSound) {\r\n    this.slideSound = this.game.add.sound('slide', 0.08, true);\r\n  }\r\n\r\n  if (!this.fallSound) {\r\n    this.fallSound = this.game.add.sound('fall', 0.1);\r\n  }\r\n\r\n  if (!this.deathSound) {\r\n    this.deathSound = this.game.add.sound('death', 0.3);\r\n    this.deathSound.onPlay.add(function() {\r\n      this.slideSound.stop();\r\n    }, this);\r\n  }\r\n\r\n  // load the audio for pieces\r\n  if (!this.pieceSound) {\r\n    this.pieceSound = this.game.add.sound('piece', 0.2);\r\n  }\r\n  // if (!this.piecesSound || this.piecesSound.length === 0) {\r\n  //   for(var i = 1; i <= 20; i++) {\r\n  //     this.piecesSound.push(this.game.add.sound('piece' + ((i < 10) ? '0' : '') + i, 0.2));\r\n  //   }\r\n  // }\r\n\r\n  // create the group that will contain the particles that will be used during\r\n  // player death\r\n  this.particlesGroup = this.game.add.group();\r\n\r\n  particleX = 0;\r\n  particleY = 0;\r\n  increaseAmount = this.player.width / this.PARTICLES_AMOUNT;\r\n\r\n  while (this.particlesGroup.children.length < Math.pow(this.PARTICLES_AMOUNT,2)) {\r\n    particle = this.game.add.sprite(particleX, particleY, 'player');\r\n    // particle.tint = this.gameObj.helper.randomColor();\r\n    particle.width = particle.height = increaseAmount;\r\n    particle.originalX = particle.x;\r\n    particle.originalY = particle.y;\r\n\r\n    this.game.physics.arcade.enable(particle);\r\n    particle.body.allowGravity = false;\r\n\r\n    this.particlesGroup.addChild(particle);\r\n\r\n    particleX += particle.width;\r\n    if (particleX >= this.player.width) {\r\n      particleX = 0;\r\n      particleY += particle.height;\r\n    }\r\n  }\r\n\r\n  this.particlesGroup.x = -100;\r\n  this.particlesGroup.y = -100;\r\n};\r\n\r\nBasicGame.Player.prototype.update = function () {\r\n  var leftPressed = false;\r\n  var rightPressed = false;\r\n  var upPressed = false;\r\n  var onRightWall = false;\r\n  var onLeftWall = false;\r\n  var headHit = false;\r\n  var jumpMul = 0;\r\n\r\n  this.game.physics.arcade.isPaused = this.gameObj.isLoadingLevel;\r\n  if (this.gameObj.isLoadingLevel) {\r\n    this.player.body.velocity.y = 0;\r\n    return;\r\n  }\r\n\r\n  if (this.gameObj.isLoadingLevel === true || this.dead === true) {\r\n    if (this.dead === true) {\r\n      this.player.body.acceleration.x = 0;\r\n      \r\n      // check if a particle is out of the world to disable its gravity\r\n      this.particlesGroup.forEach(function (particle) {\r\n        var particleX = this.particlesGroup.x + particle.x;\r\n        var particleY = this.particlesGroup.y + particle.y;\r\n        if (particleX < 0 || particleX > this.game.world.width ||\r\n            particleY > this.game.world.height) {\r\n          particle.body.allowGravity = false;\r\n          particle.body.acceleration.x = 0;\r\n          particle.body.velocity.y = 0;\r\n        }\r\n      }, this);\r\n    }\r\n    return;\r\n  }\r\n\r\n  if (this.player.y > this.game.world.height) {\r\n    this.dead = true;\r\n    this.player.body.velocity.y = 0;\r\n    this.player.body.allowGravity = false;\r\n    this.gameObj.subtractAllLifes();\r\n    return;\r\n  }\r\n\r\n  // ___________________________________________________________________________\r\n  // check collisions\r\n  // ___________________________________________________________________________\r\n\r\n  this.checkCollisions();\r\n\r\n\r\n  // ___________________________________________________________________________\r\n  // handle player movement\r\n  // ___________________________________________________________________________\r\n\r\n  leftPressed = this.leftInputIsActive() === true;\r\n  rightPressed = this.rightInputIsActive() === true;\r\n  upPressed = this.upInputIsActive() === true;\r\n\r\n  if (this.player.touchingPiece === false) {\r\n    this.onTheGround = this.player.body.touching.down === true;\r\n    onRightWall = this.player.body.touching.right === true && this.player.body.velocity.y > -500;\r\n    onLeftWall = this.player.body.touching.left === true && this.player.body.velocity.y > -500;\r\n    headHit = this.player.body.touching.up === true && this.onTheGround === false;\r\n  }\r\n\r\n  if (this.onTheGround || onRightWall || onLeftWall) {\r\n    this.jumpCount = 0;\r\n  }\r\n\r\n  // reset some values to default if the player is touching the ground\r\n  if (this.onTheGround) {\r\n    this.isFalling = false;\r\n    this.isJumping = false;\r\n    if (this.justLeaveGround === true) this.fallSound.play();\r\n    this.justLeaveGround = false;\r\n  }\r\n  else {\r\n    this.walkSound.stop();\r\n    this.slideSound.stop();\r\n\r\n    // check if the character just left the ground\r\n    if (this.justLeaveGround === false && this.player.body.velocity.y > 0) {\r\n      this.justLeaveGround = true;\r\n\r\n      // create a time to allow the player walk in the air for a while after\r\n      // leaving a platform\r\n      this.walkInAirTimer = this.game.time.create(true);\r\n      this.walkInAirTimer.add(150, function () {\r\n        this.jumpCount++;\r\n      }, this);\r\n\r\n      // restart the position of the player's body after an amount of time has\r\n      // passed\r\n      this.walkInAirTimer.start();\r\n    }\r\n  }\r\n\r\n  // handle behaviour of player on walls\r\n  if (onRightWall || onLeftWall) {\r\n    this.player.body.velocity.y = this.SLID_SPEED;\r\n\r\n    this.currentJumpMultiplier = 0;\r\n    this.jumpChance = false;\r\n\r\n    if (!this.slideSound.isPlaying) this.slideSound.play();\r\n  }\r\n\r\n  if (this.player.x < 0) this.player.x = 0;\r\n  if (this.player.right > this.game.world.width) this.player.x = this.game.world.width - this.player.width;\r\n\r\n  if (leftPressed && this.player.x > 0) {\r\n    // set the player velocity to move left\r\n    this.rightFirstPress = false;\r\n    this.player.body.acceleration.x = -this.ACCELERATION;\r\n\r\n    if (this.onTheGround) {\r\n      if (!this.leftFirstPress) {\r\n        this.leftFirstPress = true;\r\n        this.currentJumpMultiplier = 0;\r\n        this.walkSound.play();\r\n      }\r\n      else {\r\n        this.currentJumpMultiplier += this.JUMP_MULTIPLIER_AMOUNT;\r\n      }\r\n    }\r\n    else {\r\n      if (!onLeftWall) {\r\n        this.slideSound.stop();\r\n      }\r\n      else if (upPressed) {\r\n        this.player.body.acceleration.x = this.ACCELERATION_WALL;\r\n        this.player.body.velocity.y = this.JUMP_SPEED_WALL;\r\n\r\n        // jump jump jump\r\n        this.currentJumpMultiplier = 0;\r\n        this.jumpSound.play();\r\n      }\r\n    }\r\n  }\r\n  else if (rightPressed && this.player.right < this.game.world.width) {\r\n    // If the RIGHT key is down, set the player velocity to move right\r\n    this.leftFirstPress = false;\r\n    this.player.body.acceleration.x = this.ACCELERATION;\r\n\r\n    if (this.onTheGround) {\r\n      if (this.rightFirstPress === false) {\r\n        this.rightFirstPress = true;\r\n        this.currentJumpMultiplier = 0;\r\n        this.walkSound.play();\r\n      }\r\n      else {\r\n        this.currentJumpMultiplier += this.JUMP_MULTIPLIER_AMOUNT;\r\n      }\r\n    }\r\n    else {\r\n      if (!onRightWall) {\r\n        this.slideSound.stop();\r\n      }\r\n      else if (upPressed) {\r\n        this.player.body.acceleration.x = -this.ACCELERATION_WALL;\r\n        this.player.body.velocity.y = this.JUMP_SPEED_WALL;\r\n\r\n        // jump jump jump\r\n        this.currentJumpMultiplier = 0;\r\n        this.jumpSound.play();\r\n      }\r\n    }\r\n  }\r\n  else {\r\n    // not moving in X direction\r\n    this.leftFirstPress = this.rightFirstPress = false;\r\n    this.player.body.acceleration.x = 0;\r\n    this.player.body.velocity.x = 0;\r\n    this.currentJumpMultiplier = 0;\r\n    this.walkSound.stop();\r\n    this.slideSound.stop();\r\n  }\r\n\r\n  if (upPressed) {\r\n    jumpMul = Math.min(this.currentJumpMultiplier, this.JUMP_MULTIPLIER_MAX);\r\n    this.player.body.velocity.y = this.JUMP_SPEED;\r\n    this.player.body.velocity.y += this.JUMP_SPEED * jumpMul;\r\n    this.isJumping = true;\r\n    this.jumpMultiplier = this.JUMP_MULTIPLIER;\r\n\r\n    // jump jump jump\r\n    this.currentJumpMultiplier = 0;\r\n    this.jumpSound.play();\r\n  }\r\n\r\n  // make the jump a bit higher if the player keeps pressing the jump button\r\n  // if (this.input.keyboard.downDuration(this.jumpKey, this.JUMP_TIME) === true) {\r\n  //   this.player.body.velocity.y += this.JUMP_SPEED * 0.1 * this.jumpMultiplier;\r\n  //   if (this.jumpMultiplier > 0.1)\r\n  //     this.jumpMultiplier *= 0.95;\r\n  //   else\r\n  //     this.jumpMultiplier = 0;\r\n  // }\r\n  // else {\r\n  //   this.jumpMultiplier = 0;\r\n  // }\r\n\r\n  if (headHit && !this.fallSound.isPlaying) {\r\n    this.fallSound.play();\r\n  }\r\n\r\n  if (BasicGame.Game.developmentMode === true) { // [ development mode ]\r\n    this.bitmap.dirty = true;\r\n  }\r\n};\r\n\r\nBasicGame.Player.prototype.render = function() {\r\n  if (BasicGame.Game.developmentMode === true) { // [ development mode ]\r\n    // Sprite debug info\r\n    this.game.debug.bodyInfo(this.player, 0, 100, 'rgba(0,255,0,0.4)');\r\n    this.game.debug.body(this.player, 'rgba(0,255,0,0.4)');\r\n  }\r\n\r\n  if (BasicGame.Game.developmentMode === true) { // [ development mode ]\r\n    // clear the bitmap where we are drawing our lines\r\n    this.bitmap.context.clearRect(0, 0, this.game.width, this.game.height);\r\n  }\r\n};\r\n\r\nBasicGame.Player.prototype.leftInputIsActive = function () {\r\n  return this.input.keyboard.isDown(this.leftKey);\r\n};\r\n\r\nBasicGame.Player.prototype.rightInputIsActive = function () {\r\n  return this.input.keyboard.isDown(this.rightKey);\r\n};\r\n\r\nBasicGame.Player.prototype.upInputIsActive = function (duration) {\r\n  // if (this.input.keyboard.isDown(this.jumpKey) && this.jumpCount === 0) {\r\n    if (this.input.keyboard.downDuration(this.jumpKey, duration) && this.jumpCount === 0) {\r\n      this.jumpCount++;\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n/**\r\n * Method that checks collisions against walls, the ground and collectable pieces\r\n */\r\nBasicGame.Player.prototype.checkCollisions = function () {\r\n  this.player.touchingPiece = false;\r\n\r\n  if (this.level.hasFloor === true) {\r\n    this.game.physics.arcade.collide(this.player, this.level.ground);\r\n  }\r\n\r\n  // check if the player touches a piece\r\n  this.game.physics.arcade.overlap(this.player, this.level.pieces,\r\n    function(player, piece) {\r\n      player.touchingPiece = true;\r\n      piece.body.enable = false;\r\n      piece.alpha = 0;\r\n\r\n      // (this.piecesSound[this.collectedPieces++]).play();\r\n      this.collectedPieces++;\r\n      this.pieceSound.play();\r\n\r\n      if (this.collectedPieces === this.level.pieces.children.length) {\r\n        // the level has been finished\r\n        this.level.endLevel();\r\n      }\r\n    },\r\n    null,\r\n    this);\r\n\r\n  if (this.level.hasSpikes === true) {\r\n    this.game.physics.arcade.collide(this.player, this.level.walls,\r\n      function(player, spikePlatform) {\r\n        if (spikePlatform.spikeRef && spikePlatform.spikeRef.isHidden === true) {\r\n          if (this.gameObj.level.spikeSound.isPlaying === false) {\r\n            this.gameObj.level.spikeSound.play();\r\n          }\r\n          spikePlatform.spikeRef.showTween.start();\r\n        }\r\n      }, null, this);\r\n\r\n    if (this.level.spikes.openedSpikes > 0) {\r\n      this.game.physics.arcade.overlap(this.player, this.level.spikes,\r\n        function(player, spike) {\r\n          if (this.dead === false) {\r\n            this.gameObj.subtractAllLifes(true);\r\n          }\r\n        }, null, this);\r\n    }\r\n  } else {\r\n    this.game.physics.arcade.collide(this.player, this.level.walls);\r\n  }\r\n};\r\n\r\n\r\n//Function that checks if  the player is completely in shadows or not\r\nBasicGame.Player.prototype.isInShadow = function (checkLeft, checkRight) {\r\n  //Trace rays toward the light from each corner of the player sprite.\r\n  //If ALL the rays intersects a wall, then the player is in the shadows\r\n  var lightImage = BasicGame.light.lightGroup.getAt(0);\r\n  var raysToLight = [];\r\n  var offset = 8;\r\n  \r\n  if (checkLeft === true) {\r\n    // top left corner\r\n    raysToLight.push(new Phaser.Line(this.player.x + offset,\r\n      this.player.y + offset,\r\n      lightImage.x,\r\n      lightImage.y));\r\n\r\n    // bottom left corner\r\n    raysToLight.push(new Phaser.Line(this.player.x + offset,\r\n      this.player.y + this.player.height - offset,\r\n      lightImage.x,\r\n      lightImage.y));\r\n  }\r\n\r\n  if (checkRight === true) {\r\n    // top right corner\r\n    raysToLight.push(new Phaser.Line(this.player.x + this.player.width - offset,\r\n      this.player.y + offset,\r\n      lightImage.x, lightImage.y));\r\n\r\n    // bottom right corner\r\n    raysToLight.push(new Phaser.Line(this.player.x + this.player.width - offset,\r\n      this.player.y + this.player.height - offset,\r\n      lightImage.x, lightImage.y));\r\n  }\r\n\r\n  if (BasicGame.Game.developmentMode === true) {\r\n    // [ development mode ]\r\n    this.drawLinesToLight(lightImage, raysToLight);\r\n  }\r\n\r\n  // Test if any walls intersect the ray\r\n  return this.allRaysIntersectWall(raysToLight);\r\n};\r\n\r\nBasicGame.Player.prototype.allRaysIntersectWall = function (rays) {\r\n  // check intersections for each ray\r\n  // (!) if at least one ray has no intersection with a wall, then the player isn't in shadow\r\n  var hiddenRays = 0;\r\n  rays.forEach(function (ray) {\r\n    var intersect = null;\r\n\r\n    //for each of the walls...\r\n    this.level.walls.forEach(function (wall) {\r\n      if (!intersect) {\r\n        // create an array of lines that represent the four edges of each wall\r\n        var lines = [\r\n          new Phaser.Line(wall.x, wall.y, wall.x + wall.width, wall.y),\r\n          new Phaser.Line(wall.x, wall.y, wall.x, wall.y + wall.height),\r\n          new Phaser.Line(wall.x + wall.width, wall.y, wall.x + wall.width, wall.y + wall.height),\r\n          new Phaser.Line(wall.x, wall.y + wall.height, wall.x + wall.width, wall.y + wall.height)\r\n        ];\r\n\r\n        // test each of the edges in the wall against the ray from the player to the light\r\n        for (var i = 0; i < lines.length; i++) {\r\n          intersect = Phaser.Line.intersects(ray, lines[i]);\r\n          if (intersect) {\r\n            // if there is an intersect, the wall must be in the way\r\n            break;\r\n          }\r\n        }\r\n      }\r\n    }, this);\r\n\r\n    if (intersect) {\r\n      // this edge is hidden. :D\r\n      hiddenRays++;\r\n    }\r\n  },this);\r\n\r\n  return (hiddenRays === rays.length);\r\n};\r\n\r\nBasicGame.Player.prototype.drawLinesToLight = function(lightImage, raysToLight) {\r\n  // draw a line from the light to the targets\r\n  for (var i = 0; i < raysToLight.length; i++) {\r\n    this.bitmap.context.beginPath();\r\n    this.bitmap.context.moveTo(raysToLight[i].start.x, raysToLight[i].start.y);\r\n    this.bitmap.context.lineTo(lightImage.x, lightImage.y);\r\n    this.bitmap.context.stroke();\r\n  }\r\n};\r\n\r\nBasicGame.Player.prototype.updateLevel = function (level) {\r\n  this.collectedPieces = 0;\r\n  this.player.body.reset(this.player.x, this.player.y);\r\n  this.player.body.enable = false;\r\n  this.level = level;\r\n  this.justLeaveGround = false;\r\n  this.slideSound.stop();\r\n  this.player.position.set(this.level.initPlayerPos.x, this.level.initPlayerPos.y);\r\n  this.player.body.enable = true;\r\n  this.player.body.allowGravity = true;\r\n  this.dead = false;\r\n};\r\n\r\nBasicGame.Player.prototype.explote = function() {\r\n  var timer;\r\n\r\n  this.dead = true;\r\n\r\n  // stop sounds\r\n  this.slideSound.stop();\r\n  this.jumpSound.stop();\r\n  this.walkSound.stop();\r\n  this.fallSound.stop();\r\n\r\n  this.player.body.enable = false;\r\n  this.player.body.acceleration.x = 0;\r\n  this.player.body.velocity.y = 0;\r\n  this.player.body.allowGravity = false;\r\n\r\n  timer = this.game.time.create(true);\r\n  timer.add(100, function() {\r\n    this.deathSound.play();\r\n  }, this);\r\n  timer.start();\r\n\r\n  this.player.alpha = 0;\r\n\r\n  this.particlesGroup.x = this.player.x;\r\n  this.particlesGroup.y = this.player.y;\r\n\r\n  this.particlesGroup.forEach(function (particle) {\r\n    particle.x = particle.originalX;\r\n    particle.y = particle.originalY;\r\n    particle.body.allowGravity = true;\r\n    particle.body.velocity.y = -50 * this.gameObj.helper.randomNumber(10, 20);\r\n    if (this.gameObj.helper.randomNumber(1, 10) > 5) {\r\n      particle.body.acceleration.x = -this.gameObj.helper.randomNumber(100, 200);\r\n    }\r\n    else {\r\n      particle.body.acceleration.x = this.gameObj.helper.randomNumber(100, 200);\r\n    }\r\n  }, this);\r\n};\r\n\r\nBasicGame.Player.prototype.restartLevel = function () {\r\n  this.collectedPieces = 0;\r\n\r\n  this.walkSound.stop();\r\n  this.slideSound.stop();\r\n\r\n  this.player.position.set(this.level.initPlayerPos.x, this.level.initPlayerPos.y);\r\n\r\n  this.player.animations.play('normal');\r\n\r\n  this.player.body.reset(this.player.x, this.player.y);\r\n  this.game.time.create(true)\r\n  .add(100, function () {\r\n    this.player.body.enable = true;\r\n    this.player.body.allowGravity = true;\r\n  }, this)\r\n  .timer.start();\r\n  this.dead = false;\r\n};\r\n\r\nBasicGame.Player.prototype.gameInDarkness = function () {\r\n  this.player.alpha = 1;\r\n};",
    "// Color combos:\r\n// - http://www.colorcombos.com/color-schemes/6343/ColorCombo6343.html\r\n// - http://www.colorcombos.com/color-schemes/5897/ColorCombo5897.html\r\nvar BasicGame = require('BasicGame');\r\nwindow.onload = function () {\r\n\r\n    console.log('- - - - - - - - - - -');\r\n    console.log(BasicGame);\r\n\r\n    //Create your Phaser game and inject it into the gameContainer div.\r\n    //We did it in a window.onload event, but you can do it anywhere (requireJS load, anonymous function, jQuery dom ready, - whatever floats your boat)\r\n    var game = new Phaser.Game(1024, 640, Phaser.CANVAS, 'gameContainer');\r\n\r\n    //Add the States your game has.\r\n    //You don't have to do this in the html, it could be done in your Boot state too, but for simplicity I'll keep it here.\r\n    game.state.add('Boot', BasicGame.Boot);\r\n    game.state.add('Preloader', BasicGame.Preloader);\r\n    game.state.add('MainMenu', BasicGame.MainMenu);\r\n    game.state.add('Intro', BasicGame.Intro);\r\n    game.state.add('Game', BasicGame.Game);\r\n    game.state.add('GameOver', BasicGame.GameOver);\r\n    game.state.add('TheEnd', BasicGame.TheEnd);\r\n    game.state.add('Credits', BasicGame.Credits);\r\n\r\n    //Now start the Boot state.\r\n    game.state.start('Boot');\r\n};",
    "var BasicGame = require('BasicGame');\r\n\r\nBasicGame.Boot = function (game) {\r\n};\r\n\r\nBasicGame.Boot.prototype.preload = function () {\r\n  //  Here we load the assets required for our preloader (in this case a background and a loading bar)\r\n  this.load.image('preloaderBackground', 'assets/images/preloader_background-min.png');\r\n  this.load.image('preloaderBar', 'assets/images/preloader_bar.png');\r\n  this.load.image('loading_banner', 'assets/images/loading_banner.png');\r\n};\r\n\r\nBasicGame.Boot.prototype.create = function () {\r\n  //  Unless you specifically know your game needs to support multi-touch I would recommend setting this to 1\r\n  this.input.maxPointers = 1;\r\n\r\n  //  Phaser will automatically pause if the browser tab the game is in loses focus. You can disable that here:\r\n  // this.stage.disableVisibilityChange = true;\r\n\r\n  //If the parent container of the game is the browser window (ie. document.body), rather than a div, this should set to true.\r\n  this.scale.parentIsWindow = true;\r\n\r\n  // this.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;\r\n\r\n  if (this.game.device.desktop) {\r\n    //  If you have any desktop specific settings, they can go in here\r\n    this.scale.pageAlignHorizontally = true;\r\n    this.scale.pageAlignVertically = true;\r\n  } else {\r\n    //  Same goes for mobile settings.\r\n    //  In this case we're saying \"scale the game, no lower than 480x260 and no higher than 1024x768\"\r\n    this.scale.setMinMax(480, 260, 1024, 640);\r\n    this.scale.forceLandscape = true;\r\n    this.scale.pageAlignHorizontally = true;\r\n    this.scale.pageAlignVertically = true;\r\n    this.scale.setScreenSize(true);\r\n    this.scale.refresh();\r\n  }\r\n\r\n  // this.scale.setScreenSize(false);\r\n};\r\n\r\nBasicGame.Boot.prototype.update = function () {\r\n  //  By this point the preloader assets have loaded to the cache, we've set the game settings\r\n  //  So now let's start the real preloader going\r\n  if (localStorage.getItem(\"oh-my-blob\")) {\r\n    BasicGame.readCode(localStorage.getItem(\"oh-my-blob\"));\r\n  }\r\n  this.state.start('Preloader');\r\n};",
    "var BasicGame = require('BasicGame');\r\n\r\nBasicGame.Credits = function (game) {\r\n  this.mainMenuKey = Phaser.Keyboard.Z;\r\n  this.goingToMainMenu = false;\r\n  this.fontId = 'font';\r\n  this.creditsImage = null;\r\n  this.creditsMusic = null;\r\n  this.showCreditsTimer = null;\r\n};\r\n\r\nBasicGame.Credits.prototype.preload = function(){\r\n  this.load.image('credits', 'assets/images/credits-min.png');\r\n};\r\n\r\nBasicGame.Credits.prototype.create = function(){\r\n  var _self = this;\r\n\r\n  // set the default values for some properties of the state\r\n  this.goingToGame = false;\r\n\r\n  // set the backgound color\r\n  this.game.stage.backgroundColor = 0x000000;\r\n\r\n  // load the image that has the credits\r\n  this.creditsImage = this.game.add.image(0,\r\n    this.game.world.height - 200,\r\n    'credits');\r\n\r\n  // add the game title\r\n  this.gameTitle = this.game.add.image(this.game.world.width / 2,\r\n    this.game.world.height / 2, 'title');\r\n  this.gameTitle.anchor.set(0.5, 0.5);\r\n  this.gameTitle.alpha = 0;\r\n\r\n  var tapa = new Phaser.BitmapData(this.game,\r\n    'credits_tapa',\r\n    this.game.width,\r\n    this.game.height);\r\n  tapa.ctx.rect(0, 0, this.game.width, 50);\r\n  tapa.ctx.fillStyle = '#000';\r\n  tapa.ctx.fill();\r\n  this.game.add.sprite(0, this.game.height - 50, tapa);\r\n\r\n  this.mainmenuBitmapText = this.add.bitmapText(this.game.world.width - 20,\r\n    this.game.world.height - 20,\r\n    this.fontId,\r\n    \"(Z) Main menu / (Z) Menú principal\",\r\n    32,\r\n    this.textBitmapsGroup);\r\n  this.mainmenuBitmapText.align = \"left\";\r\n  this.mainmenuBitmapText.tint = 0xF2C249;\r\n  this.mainmenuBitmapText.anchor.set(1, 1);\r\n\r\n  // add the credits music\r\n  if (!this.creditsMusic) {\r\n    this.creditsMusic = this.game.add.sound('splash_music', 0.8, false);\r\n    this.creditsMusic.play();\r\n  }\r\n  else {\r\n    this.creditsMusic.play();\r\n  }\r\n\r\n  this.scrollTween = this.game.add.tween(this.creditsImage);\r\n  this.scrollTween.to({y: -this.creditsImage.height},\r\n    75 * 1000,\r\n    null,\r\n    false);\r\n\r\n  this.scrollTween.onComplete.add(function(){\r\n    // show the game name in the middle of the screen\r\n    // this.creditsMusic.fadeOut(7000);\r\n    this.alphaTween = this.game.add.tween(this.gameTitle);\r\n    this.alphaTween.to({alpha: 1},\r\n      8000,\r\n      null,\r\n      true);\r\n  }, this);\r\n\r\n  this.scrollTween.start();\r\n};\r\n\r\nBasicGame.Credits.prototype.update = function(){\r\n  if (this.goingToGame === true) {\r\n    return;\r\n  }\r\n\r\n  if (this.input.keyboard.isDown(this.mainMenuKey)) {\r\n    this.goingToGame = true;\r\n    this.creditsMusic.stop();\r\n    this.scrollTween.stop();\r\n    this.state.start('MainMenu');\r\n  }\r\n};",
    "var BasicGame = require('BasicGame');\r\n\r\nBasicGame.Game = function (game) {\r\n  // CONSTANTS\r\n  this.LIFES_AMOUNT = 3;\r\n\r\n  this.days = null;\r\n  this.player = null;\r\n  this.level = null;\r\n  this.light = null;\r\n  this.eye = null;\r\n  this.lightning = null;\r\n  this.helper = null;\r\n  this.showFPS = null;\r\n  this.map = null;\r\n  this.darknessGroup = null;\r\n  this.darknessTween = null;\r\n  this.brightnessTween = null;\r\n  this.countdownDuration = null;\r\n  this.inDarkness = null;\r\n  this.isLoadingLevel = null;\r\n  this.lifes = null;\r\n  this.lifesGroup = null;\r\n\r\n  this.music = null;\r\n};\r\n\r\nBasicGame.Game.developmentMode = false;\r\nBasicGame.isRetrying = false;\r\n\r\nBasicGame.Game.prototype.preload = function () {\r\n  // create the days object\r\n  this.days = new BasicGame.Days();\r\n\r\n  this.game.physics.startSystem(Phaser.Physics.ARCADE);\r\n\r\n  // define the size of the world\r\n  this.game.world.setBounds(0, 0, this.game.width, this.game.height);\r\n\r\n  // init the level\r\n  this.level = new BasicGame.Level(this.game, this);\r\n\r\n  // init the player\r\n  this.player = new BasicGame.Player(this.game, this.input, this);\r\n\r\n  // init a light\r\n  this.light = new BasicGame.Light(this.game, this);\r\n  BasicGame.light = this.light;\r\n\r\n  // init THE EYE\r\n  this.eye = new BasicGame.Eye(this.game, this);\r\n\r\n  // init the lightning\r\n  this.lightning = new BasicGame.Lightning(this.game, this);\r\n\r\n  // init the helper\r\n  this.helper = new BasicGame.Helper(this.game, this);\r\n};\r\n\r\nBasicGame.Game.prototype.create = function () {\r\n  // define properties\r\n  this.lifes = this.LIFES_AMOUNT;\r\n  this.showFPS = false;\r\n  this.countdownDuration = 0.7;\r\n  this.inDarkness = true;\r\n  this.isLoadingLevel = true;\r\n\r\n  // set stage background\r\n  this.background = this.game.add.tileSprite(0, 0,\r\n    this.game.world.width, this.game.world.height, this.getSkyName());\r\n\r\n  // configure the camera for shaking\r\n  this.game.camera.setSize(this.game.world.width/2, this.game.world.height/2);\r\n  this.game.camera.setPosition(0, 0);\r\n\r\n  // add the music\r\n  if (!this.music) {\r\n    this.music = this.game.add.sound('level_music', 0.1, true);\r\n  }\r\n\r\n  // create the level\r\n  this.level.create();\r\n\r\n  // create the player\r\n  this.player.create(this.level);\r\n\r\n\r\n  // create the group of sprites for lifes\r\n  this.lifesGroup = this.game.add.group();\r\n\r\n  this.createLifeIndicators();\r\n\r\n  this.lifesGroup.x = 15;\r\n  this.lifesGroup.y = 0;\r\n\r\n  // create the light\r\n  this.light.create(this.level);\r\n\r\n  // create THE EYE\r\n  this.eye.create(this.player, this.level, this.lightning);\r\n\r\n  // bring to top some things so the game looks better\r\n  if (this.level.spikes) {\r\n    this.game.world.bringToTop(this.level.spikes);\r\n  }\r\n  this.game.world.bringToTop(this.level.walls);\r\n  this.game.world.bringToTop(this.light.lightBitmap);\r\n  this.game.world.bringToTop(this.level.pieces);\r\n  this.game.world.bringToTop(this.lifesGroup);\r\n\r\n  // create the darkness\r\n  this.darknessGroup = this.add.group();\r\n  var darknessBitmap = new Phaser.BitmapData(this.game,\r\n    'darkness',\r\n    this.game.width,\r\n    this.game.height);\r\n  darknessBitmap.ctx.rect(0, 0, this.game.width, this.game.height);\r\n  darknessBitmap.ctx.fillStyle = '#000';\r\n  darknessBitmap.ctx.fill();\r\n\r\n  var darknessSprite = new Phaser.Sprite(this.game, 0, 0, darknessBitmap);\r\n\r\n  this.darknessGroup.addChild(darknessSprite);\r\n\r\n  // create the darkness tween\r\n  this.darknessTween = this.game.add.tween(this.darknessGroup.getChildAt(0));\r\n  this.darknessTween.to({alpha: 1},\r\n    this.countdownDuration * 1000,\r\n    Phaser.Easing.Quadratic.Out,\r\n    false);\r\n  this.darknessTween.onComplete.add(this.darknessTweenCompleted, this);\r\n\r\n  // create the brightness tween\r\n  this.brightnessTween = this.game.add.tween(this.darknessGroup.getChildAt(0));\r\n  this.brightnessTween.to({alpha: 0},\r\n    700,\r\n    null,\r\n    false);\r\n  this.brightnessTween.onComplete.add(this.brightnessTweenCompleted, this);\r\n\r\n  // create flash sprite\r\n  this.flashGroup = this.add.group();\r\n  var flashBitmap = new Phaser.BitmapData(this.game,\r\n    'flash',\r\n    this.game.width,\r\n    this.game.height);\r\n  flashBitmap.ctx.rect(0, 0, this.game.width, this.game.height);\r\n  flashBitmap.ctx.fillStyle = '#fff';\r\n  flashBitmap.ctx.fill();\r\n\r\n  var flashSprite = new Phaser.Sprite(this.game, 0, 0, flashBitmap);\r\n  flashSprite.alpha = 0;\r\n  this.flashGroup.addChild(flashSprite);\r\n\r\n  if (this.level.isReady === true) {\r\n    this.levelReady();\r\n  }\r\n\r\n  // show FPS\r\n  if (BasicGame.Game.developmentMode) {\r\n    this.game.time.advancedTiming = true;\r\n    this.fpsText = this.game.add.text(this.game.world.width / 2 - 80, 100, '', { font: '80px Arial', fill: '#fefefe' });\r\n  }\r\n};\r\n\r\nBasicGame.Game.prototype.update = function () {\r\n  // update the light\r\n  this.light.update();\r\n\r\n  // update The Player\r\n  this.player.update(this.light);\r\n\r\n  // update The Eye\r\n  this.eye.update();\r\n\r\n  // update the lightning\r\n  this.lightning.update();\r\n\r\n  // show development information\r\n  if (BasicGame.Game.developmentMode) {\r\n    if (this.game.time.fps !== 0) {\r\n      this.fpsText.setText(this.game.time.fps + ' FPS');\r\n    }\r\n  }\r\n};\r\n\r\nBasicGame.Game.prototype.levelReady = function () {\r\n  this.level.isReady = false;\r\n\r\n  if (BasicGame.isRetrying === false)\r\n  {\r\n    this.level.showDay();\r\n  }\r\n  else\r\n  {\r\n    this.level.levelTextGroup.alpha = 0;\r\n    this.hideDarkness();\r\n  }\r\n};\r\n\r\nBasicGame.Game.prototype.levelEnded = function () {\r\n  // notify to the eye that the level was ended\r\n  this.eye.endLevel(true);\r\n\r\n  if (this.inDarkness === false) {\r\n    this.helper.timer(100, this.levelEnded.bind(this));\r\n    return;\r\n  }\r\n\r\n  this.isLoadingLevel = true;\r\n  this.loadLevel(++BasicGame.currentLevel);\r\n};\r\n\r\nBasicGame.Game.prototype.render = function () {\r\n  this.player.render();\r\n  this.level.render();\r\n};\r\n\r\nBasicGame.Game.prototype.quitGame = function () {\r\n  //Here you should destroy anything you no longer need.\r\n  //Stop music, delete sprites, purge caches, free resources, all that good stuff.\r\n  this.state.start('MainMenu');\r\n};\r\n\r\nBasicGame.Game.prototype.loadLevel = function (levelNumber) {\r\n  if (levelNumber > 30) {\r\n    // congrats, you ended the game\r\n    this.state.start('TheEnd');\r\n    return;\r\n  }\r\n\r\n  this.level.destroyCurrentLevel();\r\n\r\n  var skyName = this.getSkyName();\r\n  if (this.background.key != skyName) {\r\n    this.load.image(skyName,\r\n      'assets/images/' + skyName + '-min.png');\r\n  }\r\n\r\n  this.game.load.onLoadComplete.addOnce(function () {\r\n    if (this.background.key != skyName) {\r\n      this.background.loadTexture(skyName);\r\n    }\r\n\r\n    this.level.createLevel(levelNumber);\r\n\r\n    this.player.updateLevel(this.level);\r\n    this.light.updateWalls(this.level);\r\n    this.eye.updateLevel(this.level);\r\n    this.lightning.updateLevel(this.level);\r\n\r\n    this.game.world.bringToTop(this.light.lightBitmap);\r\n    this.game.world.bringToTop(this.level.pieces);\r\n    this.game.world.bringToTop(this.lifesGroup);\r\n    this.game.world.bringToTop(this.darknessGroup);\r\n\r\n    if (this.level.isReady === true) {\r\n      BasicGame.isRetrying = false;\r\n      this.levelReady();\r\n    }\r\n  }, this);\r\n\r\n  var levelData = this.helper.getLevelIdAndName(levelNumber);\r\n  this.game.load.tilemap(levelData.id,\r\n    'assets/tilemaps/maps/' + levelData.name + '.json',\r\n    null,\r\n    Phaser.Tilemap.TILED_JSON);\r\n\r\n  this.game.load.start();\r\n\r\n  // localStorage.setItem(\"oh-my-blob\", BasicGame.setDay(levelNumber));\r\n};\r\n\r\nBasicGame.Game.prototype.shakeCamera = function () {\r\n  // shake the camera by moving it up and down 5 times really fast\r\n  this.game.camera.y = 10;\r\n  this.game.camera.x = 10;\r\n\r\n  // create the tween for shaking the camera\r\n  this.shakeTween = this.game.add.tween(this.game.camera);\r\n  this.shakeTween.to({y: -5, x: -5},\r\n    40,\r\n    Phaser.Easing.Sinusoidal.InOut,\r\n    false,\r\n    0,\r\n    4,\r\n    true);\r\n\r\n  this.shakeTween.onComplete.add(function () {\r\n    // set the camera position to its initial position\r\n    this.game.camera.setPosition(0, 0);\r\n    this.shakeTween.stop();\r\n  }, this);\r\n\r\n  this.shakeTween.start();\r\n};\r\n\r\nBasicGame.Game.prototype.subtractLife = function () {\r\n  var that = this;\r\n\r\n  // if the player collected all the pieces, don't kill him\r\n  if (this.level.endTimer) return;\r\n\r\n  // remove one life sprite\r\n  if (this.lifes <= 0) {\r\n    return;\r\n  }\r\n\r\n  var lifeTween = this.game.add.tween(this.lifesGroup.getChildAt(--this.lifes));\r\n  lifeTween.to({alpha: 0},\r\n    300,\r\n    Phaser.Easing.Quadratic.Out,\r\n    true);\r\n\r\n  // create the tween for shaking the camera\r\n  this.flashTween = this.game.add.tween(this.flashGroup.getChildAt(0));\r\n  this.flashTween.to({alpha: 1},\r\n    40,\r\n    Phaser.Easing.Sinusoidal.InOut,\r\n    false,\r\n    0,\r\n    4,\r\n    true);\r\n\r\n  this.flashTween.onComplete.add(function () {\r\n    this.flashTween.stop();\r\n  }, this);\r\n\r\n  this.flashTween.start();\r\n\r\n  if (this.lifes <= 0) {\r\n    // save the current level\r\n    // localStorage.setItem(\"oh-my-blob\", BasicGame.addDeath());\r\n\r\n    // notify the PLAYER that its time to show the animation for dead\r\n    this.player.explote();\r\n\r\n    // notify to the EYE the player has died\r\n    this.eye.rejoice(function () {\r\n      that.showDarkness(200);\r\n    });\r\n  }\r\n};\r\n\r\nBasicGame.Game.prototype.subtractAllLifes = function (destroyPlayer) {\r\n  // if the player collected all the pieces, don't kill him\r\n  if (this.level.endTimer) {\r\n    return;\r\n  }\r\n\r\n  // localStorage.setItem(\"oh-my-blob\", BasicGame.addDeath());\r\n\r\n  this.lifes = 0;\r\n\r\n  var lifeTween = this.game.add.tween(this.lifesGroup);\r\n  lifeTween.to({alpha: 0},\r\n    180,\r\n    Phaser.Easing.Quadratic.Out,\r\n    true);\r\n\r\n  this.eye.endLevel(false);\r\n\r\n  if (destroyPlayer) {\r\n    // play the animation of death of the player\r\n    this.player.explote();\r\n\r\n    // create the timer to give the player die animation time to be played\r\n    this.helper.timer(1000,\r\n      function () {\r\n        this.showDarkness(200);\r\n      },\r\n      this);\r\n  } else {\r\n    this.showDarkness(200);\r\n  }\r\n};\r\n\r\nBasicGame.Game.prototype.showDarkness = function (durationInMS) {\r\n  this.game.world.bringToTop(this.darknessGroup);\r\n  this.darknessTween.updateTweenData(\"duration\", durationInMS || this.countdownDuration * 1000);\r\n  this.darknessTween.start();\r\n};\r\n\r\nBasicGame.Game.prototype.darknessTweenCompleted = function () {\r\n  this.inDarkness = true;\r\n\r\n  this.eye.gameInDarkness();\r\n  this.player.gameInDarkness();\r\n\r\n  this.showLifes();\r\n  if (this.lifes <= 0) {\r\n    this.restartLevel(true);\r\n  }\r\n};\r\n\r\nBasicGame.Game.prototype.hideDarkness = function (durationInMS) {\r\n  this.inDarkness = false;\r\n  this.brightnessTween.updateTweenData(\"duration\", durationInMS || this.countdownDuration * 1000);\r\n  this.brightnessTween.start();\r\n};\r\n\r\nBasicGame.Game.prototype.brightnessTweenCompleted = function () {\r\n  // this.eye.eyeStateTimer = this.eye.searchingTime;\r\n  this.isLoadingLevel = false;\r\n\r\n  this.lifes = this.LIFES_AMOUNT;\r\n\r\n  // make the EYE seek for the player\r\n  this.eye.levelStart();\r\n\r\n  if (this.music.isPlaying === false) {\r\n    // this.music.play();\r\n  }\r\n\r\n  this.player.player.body.enable = true;\r\n};\r\n\r\nBasicGame.Game.prototype.restartLevel = function (runHideDarkness) {\r\n  // restore the alpha for life indicators and lifes group\r\n  this.lifes = this.LIFES_AMOUNT;\r\n  this.showLifes();\r\n\r\n  this.player.restartLevel();\r\n  this.level.restartLevel();\r\n  this.eye.restartLevel();\r\n\r\n  if (runHideDarkness === true) {\r\n    this.hideDarkness(200);\r\n  }\r\n};\r\n\r\nBasicGame.Game.prototype.createLifeIndicators = function () {\r\n  for (var i=0; i<this.lifes; i++) {\r\n    var lifeSprite = new Phaser.Sprite(this.game, 0, 0, \"player\");\r\n    lifeSprite.scale.set(0.5, 0.8);\r\n    lifeSprite.x = (i % 3) * (lifeSprite.width + 6);\r\n\r\n    this.lifesGroup.addChild(lifeSprite);\r\n  }\r\n};\r\n\r\nBasicGame.Game.prototype.showLifes = function () {\r\n  this.lifesGroup.alpha = 1;\r\n  this.lifesGroup.forEach(function (lifeSprite) {\r\n    lifeSprite.alpha = 1;\r\n  });\r\n};\r\n\r\nBasicGame.Game.prototype.getSkyName = function () {\r\n  return this.helper.getSkyName(BasicGame.currentLevel);\r\n};",
    "var BasicGame = require('BasicGame');\r\n\r\nBasicGame.GameOver = function(game){\r\n  this.fontId = 'font';\r\n\r\n  this.gameOverBitmap = null;\r\n  this.gameOverGroup = null;\r\n\r\n  this.phraseBitmap = null;\r\n  this.phraseGroup = null;\r\n\r\n  this.tryAgainBitmap = null;\r\n  this.sPressedFlag = false;\r\n\r\n  this.bSpeech = {\r\n    \"a\": {\r\n      \"es\": \"Bill: Pensé que lo había superado.\",\r\n      \"en\": \"Bill: I thought I had overcome this.\"\r\n    },\r\n    \"b\": {\r\n      \"es\": \"Bill: Creo que nunca lograré superarlo.\",\r\n      \"en\": \"Bill: I think I'll never be able to get over this.\"\r\n    },\r\n    \"c\": {\r\n      \"es\": \"Bill: No puedo más con esto.\",\r\n      \"en\": \"Bill: I can't handle this.\"\r\n    }\r\n  };\r\n\r\n  this.hSpeech = {\r\n    \"es\": \"Hub: Espera...¿Qué vas a hacer?\",\r\n    \"en\": \"Hub: Wait...¿What are you going to do?\"\r\n  };\r\n\r\n  this.tryAgainText = {\r\n    \"es\": \"Reintentar (Barra espaciadora)\",\r\n    \"en\": \"Try again (Spacebar)\"\r\n  };\r\n  this.tryAgainKey = Phaser.Keyboard.SPACEBAR;\r\n};\r\n\r\nBasicGame.GameOver.prototype.create = function(){\r\n  // set stage background\r\n  // this.game.stage.backgroundColor = 0x000;\r\n  this.background = this.game.add.tileSprite(0, 0,\r\n    this.game.world.width, this.game.world.height, this.getSkyName());\r\n  this.background.alpha = 0.3;\r\n\r\n  // create the group and text for the \"Game Over\" text\r\n  this.gameOverGroup = this.game.add.group();\r\n  this.dialogTextBitmap = this.add.bitmapText(this.game.world.width/2,\r\n    this.game.world.height/2 - 20,\r\n    this.fontId,\r\n    this.getPhrase(),\r\n    48,\r\n    this.gameOverGroup);\r\n  this.dialogTextBitmap.anchor.set(.5, .5);\r\n  this.dialogTextBitmap.tint = 0xFFFFFF;\r\n\r\n  // create the group and text for the phrase\r\n  this.phraseGroup = this.game.add.group();\r\n  this.phraseBitmap = this.add.bitmapText(this.game.world.width/2,\r\n    this.dialogTextBitmap.bottom + 20,\r\n    this.fontId,\r\n    this.hSpeech[BasicGame.language],\r\n    48,\r\n    this.phraseGroup);\r\n  this.phraseBitmap.anchor.set(.5, .5);\r\n  this.phraseBitmap.tint = 0xFFFF50;\r\n\r\n  // create the group and text for Try again\r\n  this.tryAgainGroup = this.game.add.group();\r\n  this.tryAgainBitmap = this.game.add.bitmapText(this.game.world.width/2,\r\n    this.game.world.height/2 + 280,\r\n    this.fontId,\r\n    this.tryAgainText[BasicGame.language],\r\n    36,\r\n    this.tryAgainGroup);\r\n  this.tryAgainBitmap.anchor.set(.5, .5);\r\n  this.tryAgainBitmap.tint = 0xF2C249;\r\n\r\n  // add the keyboard listener for Try again\r\n  this.game.input.keyboard.addKeyCapture([\r\n    this.tryAgainKey\r\n  ]);\r\n};\r\n\r\nBasicGame.GameOver.prototype.update = function(){\r\n  if(this.input.keyboard.isDown(this.tryAgainKey)\r\n      && this.sPressedFlag == false){\r\n    BasicGame.isRetrying = true;\r\n    this.state.start('Game');\r\n  }else if(!this.input.keyboard.isDown(this.tryAgainKey) && this.sPressedFlag == true){\r\n    this.sPressedFlag = false;\r\n  }\r\n};\r\n\r\nBasicGame.GameOver.prototype.getPhrase = function(){\r\n  if(BasicGame.currentLevel <= 10){\r\n    return this.bSpeech.a[BasicGame.language];\r\n  } else if (BasicGame.currentLevel <= 20) {\r\n    return this.bSpeech.b[BasicGame.language];\r\n  } else {\r\n    return this.bSpeech.c[BasicGame.language];\r\n  }\r\n};\r\n\r\nBasicGame.GameOver.prototype.getSkyName = function(){\r\n  if(BasicGame.currentLevel <= 10){\r\n    return 'sky01';\r\n  } else if (BasicGame.currentLevel <= 20) {\r\n    return 'sky02';\r\n  } else {\r\n    return 'sky03';\r\n  }\r\n};",
    "var BasicGame = require('BasicGame');\r\n\r\nBasicGame.Intro = function (game) {\r\n  this.background = null;\r\n  this.skipKey = Phaser.Keyboard.Z;\r\n  \r\n  this.fontId = 'font';\r\n  this.textColors = {\r\n    'Hub': 0xFFFF50,\r\n    'Bill': 0xFFFFFF\r\n  };\r\n  this.dialogs = {\r\n    \"es\": [\r\n      {\r\n        character: 'Hub',\r\n        text: 'Tienes que calmarte, todo estará bien.',\r\n        bips: 3\r\n      },\r\n      {\r\n        character: 'Bill',\r\n        text: '¿Cómo puedes decir eso? No puedo hacerlo!',\r\n        bips: 3\r\n      },\r\n      {\r\n        character: 'Hub',\r\n        text: 'Descansa, ya verás cómo en unos días dejará de acecharte.',\r\n        bips: 5\r\n      },\r\n      {\r\n        character: 'Bill',\r\n        text: 'Creo que no seré capaz...',\r\n        bips: 2\r\n      }\r\n    ],\r\n    \"en\": [\r\n      {\r\n        character: 'Hub',\r\n        text: 'Calm down, all its going to be fine.',\r\n        bips: 3\r\n      },\r\n      {\r\n        character: 'Bill',\r\n        text: \"How can you say that? I can't do that!\",\r\n        bips: 3\r\n      },\r\n      {\r\n        character: 'Hub',\r\n        text: 'Have a rest, it will stop haunting you in a few days.',\r\n        bips: 4\r\n      },\r\n      {\r\n        character: 'Bill',\r\n        text: \"I think I won't be able to handle this...\",\r\n        bips: 3\r\n      }\r\n    ]\r\n  };\r\n  this.textBitmapsGroup = null;\r\n  this.dialogTextBitmap = null;\r\n  this.dialogNumber = 0;\r\n  this.dialogTween = null;\r\n\r\n  this.skipGroup = null;\r\n  this.skipBitmap = null;\r\n  this.skipText = {\r\n    \"es\": \"Siguiente (Z)\",\r\n    \"en\": \"Next (Z)\"\r\n  };\r\n  this.sPressedFlag = false;\r\n\r\n  this.goingToGame = false;\r\n\r\n  this.BSound = null;\r\n  this.HSound = null;\r\n  this.soundLoopTimer = null;\r\n};\r\n\r\nBasicGame.Intro.prototype.create = function(){\r\n  // set the backgound\r\n  this.game.stage.backgroundColor = 0x000000;\r\n  // this.background = this.game.add.tileSprite(0, 0,\r\n  //   this.game.world.width, this.game.world.height, \"sky03\");\r\n  // this.background.alpha = 0.2;\r\n\r\n  // create the group and text for the dialog and the Skip\r\n  this.textBitmapsGroup = this.game.add.group();\r\n\r\n  this.dialogTextBitmap = this.add.bitmapText(this.game.world.width / 2,\r\n    this.game.world.height / 2,\r\n    this.fontId,\r\n    '???',\r\n    36,\r\n    this.textBitmapsGroup);\r\n  this.dialogTextBitmap.align = \"left\";\r\n  this.dialogTextBitmap.anchor.set(.5, .5);\r\n  this.dialogTextBitmap.alpha = 0;\r\n\r\n  // create the group and the text for Skip\r\n  this.skipGroup = this.game.add.group();\r\n  this.skipBitmap = this.add.bitmapText(this.game.world.width - 20,\r\n    this.game.world.height - 20,\r\n    this.fontId,\r\n    this.skipText[BasicGame.language],\r\n    32,\r\n    this.textBitmapsGroup);\r\n  this.skipBitmap.align = \"left\";\r\n  this.skipBitmap.tint = 0xF2C249;\r\n  this.skipBitmap.anchor.set(1, 1);\r\n\r\n  // add the keyboard listener for Skip\r\n  this.game.input.keyboard.addKeyCapture([\r\n    this.skipKey\r\n  ]);\r\n\r\n  // create the tween to use in the dialog\r\n  this.dialogTween = this.game.add.tween(this.dialogTextBitmap);\r\n  this.dialogTween.to({alpha: 1},\r\n    300,\r\n    Phaser.Easing.Quadratic.Out,\r\n    false);\r\n\r\n  // load the sounds of B and H\r\n  this.BSound = this.game.add.sound('b', 0.2);\r\n  this.HSound = this.game.add.sound('h', 0.2);\r\n\r\n  // show the first dialog\r\n  this.updateDialog();\r\n};\r\n\r\nBasicGame.Intro.prototype.update = function(){\r\n  if(this.goingToGame === true){\r\n    return;\r\n  }\r\n\r\n  if(this.input.keyboard.isDown(this.skipKey)\r\n      && this.sPressedFlag == false){\r\n    this.sPressedFlag = true;\r\n    this.dialogTween.onComplete.dispatch(this.dialogTween.target, this.dialogTween);\r\n    // this.dialogTextBitmap.alpha = 1;\r\n    this.updateDialog();\r\n  }else if(!this.input.keyboard.isDown(this.skipKey) && this.sPressedFlag == true){\r\n    this.sPressedFlag = false;\r\n  }\r\n};\r\n\r\nBasicGame.Intro.prototype.updateDialog = function(){\r\n  if(this.dialogNumber <= this.dialogs[BasicGame.language].length - 1){\r\n    var dialogObj = this.dialogs[BasicGame.language][this.dialogNumber];\r\n    // there are still dialogs to be shown\r\n    var currentDialogLine = dialogObj.text;\r\n    var character = dialogObj.character;\r\n\r\n    this.dialogTextBitmap.tint = this.textColors[character];\r\n    this.dialogTextBitmap.setText(character + ': ' + currentDialogLine);\r\n\r\n    this.dialogTextBitmap.alpha = 0;\r\n    this.dialogTween.start();\r\n\r\n    // play the bips of the dialog\r\n    if (dialogObj.bips > 0) {\r\n      this.soundLoopTimer = this.game.time.create(true);\r\n      this.soundLoopTimer.repeat(100, dialogObj.bips, function(){\r\n        this[dialogObj.character.charAt(0) + \"Sound\"].play();\r\n      }, this);\r\n      this.soundLoopTimer.start();\r\n    }\r\n\r\n    this.dialogNumber++;\r\n  }else{\r\n    // tween the dialog bitmap to alpha = 0, then, start the game.\r\n    this.goingToGame = true;\r\n    this.game.add.tween(this.textBitmapsGroup).to({alpha: 0},\r\n      500,\r\n      Phaser.Easing.Quadratic.Out,\r\n      true)\r\n      .onComplete.add(function(){\r\n        this.state.start('Game');\r\n      },this);\r\n  }\r\n};",
    "var BasicGame = require('BasicGame');\r\n\r\nBasicGame.MainMenu = function (game) {\r\n  this.splash_music = null;\r\n  this.playButton = null;\r\n  this.jugarButton = null;\r\n  this.showIntroTimer = null;\r\n  this.enSound = null;\r\n  this.esSound = null;\r\n  this.listenKeys = false;\r\n\r\n  this.fontId = 'font';\r\n  this.creditsTextBitmap = null;\r\n  this.restartTextBitmap = null;\r\n};\r\n\r\nBasicGame.MainMenu.prototype.create = function(){\r\n  var _self = this;\r\n\r\n  // set stage background\r\n  this.background = this.game.add.tileSprite(0, 0,\r\n    this.game.world.width, this.game.world.height,\r\n    BasicGame.Helper.prototype.getSkyName(BasicGame.currentLevel));\r\n\r\n  // add the fake zone of view for the splash screen\r\n  this.fakeViewZone = this.game.add.image(this.game.world.width / 2, 0, 'splash_view');\r\n  this.fakeViewZone.anchor.set(0.5, 0);\r\n  this.fakeViewZone.alpha = 0;\r\n  this.fakeViewZone.tint = 0xFFFC19;\r\n\r\n  // add the fake EYE\r\n  this.fakeEye = this.game.add.sprite(this.game.world.width / 2, 64, 'eye', 10);\r\n  this.fakeEye.anchor.set(0.5, 0.5);\r\n  this.pupil = this.game.add.image(this.fakeEye.x, this.fakeEye.y, 'pupil');\r\n  this.pupil.anchor.set(0.5, 0.5);\r\n  this.pupil.alpha = 0;\r\n\r\n  // draw floors and platforms\r\n  this.map = this.game.add.tilemap('splash_lvl');\r\n  this.ground = this.game.add.group();\r\n  this.map.createFromObjects(\"floor\", \"\", 'platform', 0, true, false,\r\n    this.ground, Phaser.Sprite, false);\r\n  this.walls = this.game.add.group();\r\n  this.map.createFromObjects(\"platforms\", \"\", 'platform', 0, true, false,\r\n    this.walls, Phaser.Sprite, false);\r\n\r\n  // add the fake player\r\n  this.fakeplayer = this.game.add.sprite(this.map.objects.player_pos[0].x,\r\n    this.map.objects.player_pos[0].y,\r\n    'player');\r\n  this.movingPlayer = false;\r\n\r\n  // add light and generate shadows\r\n  this.light = new BasicGame.Light(this.game, this);\r\n  this.light.create(this);\r\n  this.light.drawShadows();\r\n\r\n  // create the play buttons\r\n  this.buttons = this.game.add.group();\r\n  this.playButton = this.add.sprite(-20, this.world.height - 150,\r\n    (BasicGame.currentLevel === 1) ? 'playButton' : 'continueButton', 0);\r\n  this.playButton.anchor.set(0, 0);\r\n  this.playButton.scale.setTo(0.5, 0.5);\r\n  this.playButton.alpha = 0.8;\r\n\r\n  this.jugarButton = this.add.sprite(this.world.width + 20, this.world.height - 150,\r\n    (BasicGame.currentLevel === 1) ? 'jugarButton' : 'continuarButton', 0);\r\n  this.jugarButton.anchor.set(1, 0);\r\n  this.jugarButton.scale.setTo(0.5, 0.5);\r\n  this.jugarButton.alpha = 0.8;\r\n\r\n  // create the credits button\r\n  this.creditsTextBitmap = this.add.bitmapText(this.game.world.width / 2,\r\n    this.game.world.height - 32,\r\n    this.fontId,\r\n    '(C) Credits/Créditos',\r\n    36);\r\n  this.creditsTextBitmap.align = \"center\";\r\n  this.creditsTextBitmap.anchor.set(0.5, 0);\r\n\r\n\r\n  if (BasicGame.currentLevel > 1) {\r\n    this.restartTextBitmap = this.add.bitmapText((this.game.world.width / 2) + 10,\r\n      this.game.world.height - 32,\r\n      this.fontId,\r\n      '(R) Restart/Reiniciar',\r\n      36);\r\n    this.restartTextBitmap.align = \"center\";\r\n\r\n    this.creditsTextBitmap.anchor.set(1, 0);\r\n    this.creditsTextBitmap.x -= 10;\r\n  }\r\n\r\n  this.buttons.addChild(this.playButton);\r\n  this.buttons.addChild(this.jugarButton);\r\n  this.buttons.addChild(this.creditsTextBitmap);\r\n  if (BasicGame.currentLevel > 1) {\r\n    this.buttons.addChild(this.restartTextBitmap);\r\n  }\r\n  this.buttons.alpha = 0;\r\n\r\n  // add the game title\r\n  this.gameTitle = this.game.add.image(this.game.world.width / 2 - 5,\r\n    this.game.world.height / 2 + 150, 'title');\r\n  this.gameTitle.anchor.set(0.5, 0.5);\r\n\r\n  // add key listeners\r\n  this.game.input.keyboard.addKeyCapture([\r\n    Phaser.Keyboard.LEFT,\r\n    Phaser.Keyboard.RIGHT\r\n  ]);\r\n\r\n  // load sounds\r\n  if (!this.enSound) {\r\n    this.enSound = this.game.add.sound('en-lang', 0.2);\r\n  }\r\n\r\n  if (!this.esSound) {\r\n    this.esSound = this.game.add.sound('es-lang', 0.2);\r\n  }\r\n\r\n  // create the go-to-next-state timer\r\n  this.showIntroTimer = this.game.time.create(true);\r\n  this.showIntroTimer.add(200,\r\n    function(){\r\n      this.showIntro();\r\n    },\r\n    this);\r\n\r\n  // add the splash_music\r\n  if (!this.splash_music) {\r\n    this.splash_music = this.game.add.sound('splash_music', 0.2, true);\r\n    this.splash_music.onFadeComplete.addOnce(function(soundObj) {\r\n      soundObj.stop();\r\n    }, this);\r\n    this.splash_music.play();\r\n  }\r\n\r\n  // DARKNESS\r\n  if (BasicGame.currentLevel === 1) {\r\n    this.darknessGroup = this.add.group();\r\n    var darknessBitmap = new Phaser.BitmapData(this.game,\r\n      'darkness_main',\r\n      this.game.width,\r\n      this.game.height);\r\n    darknessBitmap.ctx.rect(0, 0, this.game.width, this.game.height);\r\n    darknessBitmap.ctx.fillStyle = '#000';\r\n    darknessBitmap.ctx.fill();\r\n    var darknessSprite = new Phaser.Sprite(this.game, 0, 0, darknessBitmap);\r\n    this.darknessGroup.addChild(darknessSprite);\r\n\r\n    this.darknessTween = this.game.add.tween(this.darknessGroup.getChildAt(0));\r\n    this.darknessTween.to({alpha: 0},\r\n      5000,\r\n      Phaser.Easing.Quadratic.Out,\r\n      true,\r\n      4500);\r\n    this.darknessTween.onComplete.add(function(){\r\n      this.showButtons();\r\n    }, this);\r\n  }\r\n  else {\r\n    this.showButtons();\r\n  }\r\n};\r\n\r\nBasicGame.MainMenu.prototype.update = function(){\r\n  if (this.listenKeys === false ||\r\n      this.movingPlayer === true) {\r\n    return;\r\n  }\r\n\r\n  if (this.input.keyboard.isDown(Phaser.Keyboard.LEFT)) {\r\n    // this.world.bringToTop(this.playButton);\r\n    this.enSound.play();\r\n    this.playButton.frame = 1;\r\n    this.playButton.alpha = 1;\r\n    this.moveFakePlayer(-32);\r\n  }\r\n  else if(this.input.keyboard.isDown(Phaser.Keyboard.RIGHT)){\r\n    // this.world.bringToTop(this.jugarButton);\r\n    this.esSound.play();\r\n    this.jugarButton.frame = 1;\r\n    this.jugarButton.alpha = 1;\r\n    BasicGame.language = \"es\";\r\n    this.moveFakePlayer(this.game.world.width + 32);\r\n  }\r\n  else if (this.input.keyboard.isDown(Phaser.Keyboard.C)) {\r\n    // load the credits scene\r\n    this.listenKeys = false;\r\n    this.splash_music.stop();\r\n    this.state.start('Credits');\r\n  }\r\n  else if (this.input.keyboard.isDown(Phaser.Keyboard.R)) {\r\n\r\n    // clean the localStorage, then set the currrent level to 1, show intro\r\n    this.listenKeys = false;\r\n    localStorage.removeItem(\"oh-my-blob\");\r\n    BasicGame.reset();\r\n    this.splash_music.stop();\r\n    this.showIntro();\r\n  }\r\n\r\n};\r\n\r\nBasicGame.MainMenu.prototype.moveFakePlayer = function (targetX) {\r\n  this.splash_music.fadeOut(1480);\r\n  this.movingPlayer = true;\r\n  var moveTween = this.game.add.tween(this.fakeplayer)\r\n    .to({x: targetX},\r\n      1500,\r\n      null,\r\n      false);\r\n  moveTween.onComplete.add(function(){\r\n    this.showIntro();\r\n  }, this);\r\n  moveTween.start();\r\n};\r\n\r\nBasicGame.MainMenu.prototype.showButtons = function () {\r\n  var showButtonsTween = this.game.add.tween(this.buttons)\r\n    .to({alpha: 1},\r\n      1000,\r\n      null,\r\n      false);\r\n  showButtonsTween.onComplete.add(function(){\r\n    this.fakeEye.frame = 0;\r\n    this.pupil.alpha = 1;\r\n    this.fakeViewZone.alpha = 0.1;\r\n    this.listenKeys = true;\r\n  }, this);\r\n  showButtonsTween.start();\r\n};\r\n\r\nBasicGame.MainMenu.prototype.showIntro = function(){\r\n  this.state.start((BasicGame.currentLevel === 1) ? 'Intro' : 'Game');\r\n};\r\n",
    "var BasicGame = require('BasicGame');\r\n\r\nBasicGame.Preloader = function (game) {\r\n  this.background = null;\r\n  this.preloadBar = null;\r\n  this.ready = false;\r\n};\r\n\r\nBasicGame.Preloader.prototype.preload = function(){\r\n  var i = 0;\r\n\r\n  // these are the assets we loaded in Boot.js\r\n  // a nice sparkly background and a loading progress bar\r\n  this.background = this.add.sprite(0, 0, 'preloaderBackground');\r\n  this.banner = this.add.image(this.game.world.width / 2,\r\n    this.game.world.height - 40,\r\n    'loading_banner');\r\n  this.banner.anchor.set(0.5, 0);\r\n  this.preloadBar = this.add.sprite(0, 0, 'preloaderBar');\r\n\r\n  // set the preloadBar sprite as a loader sprite.\r\n  // automatically crop the sprite from 0 to full-width as the\r\n  // files below are loaded in.\r\n  this.load.setPreloadSprite(this.preloadBar, 1);\r\n\r\n  //  ---| load the assets for the Main menu\r\n  this.load.image('splash_view', 'assets/images/splash_view.png');\r\n  this.load.image('title', 'assets/images/title.png');\r\n  this.load.spritesheet('playButton','assets/sprites/play_button.png', 400, 256);\r\n  this.load.spritesheet('jugarButton','assets/sprites/jugar_button.png', 400, 256);\r\n  this.load.spritesheet('continueButton','assets/sprites/continue_button.png', 400, 256);\r\n  this.load.spritesheet('continuarButton','assets/sprites/continuar_button.png', 400, 256);\r\n  this.load.image('pupil', 'assets/images/pupil.png');\r\n  this.load.audio('splash_music', 'assets/music/splash_music.ogg', true);\r\n  this.load.audio('en-lang', 'assets/soundfx/en.ogg', true);\r\n  this.load.audio('es-lang', 'assets/soundfx/es.ogg', true);\r\n  this.game.load.tilemap('splash_lvl', 'assets/tilemaps/maps/splash.json',\r\n    null, Phaser.Tilemap.TILED_JSON);\r\n\r\n  //  ---| load the assets for the Game\r\n  this.load.image('light', 'assets/images/light.png');\r\n  this.load.image('view_zone', 'assets/images/view_zone.png');\r\n  this.load.image('piece', 'assets/images/piece.png');\r\n  this.load.image('platform', 'assets/images/platform.png');\r\n  this.load.spritesheet('player','assets/sprites/player.png', 32, 32);\r\n  this.load.spritesheet('eye','assets/sprites/eye.png', 192, 96);\r\n  this.load.audio('b', 'assets/soundfx/b.ogg', true);\r\n  this.load.audio('h', 'assets/soundfx/h.ogg', true);\r\n  this.load.audio('jump', 'assets/soundfx/jump.ogg', true);\r\n  this.load.audio('walk', 'assets/soundfx/walk.ogg', true);\r\n  this.load.audio('slide', 'assets/soundfx/slide.ogg', true);\r\n  this.load.audio('fall', 'assets/soundfx/fall.ogg', true);\r\n  this.load.audio('death', 'assets/soundfx/death.ogg', true);\r\n  this.load.audio('day', 'assets/soundfx/day.ogg', true);\r\n  this.load.audio('ray', 'assets/soundfx/ray.ogg', true);\r\n  this.load.audio('eye', 'assets/soundfx/eye.ogg', true);\r\n  this.load.audio('eye-anger', 'assets/soundfx/anger.ogg', true);\r\n  this.load.audio('level_music', 'assets/music/levels_music.ogg', true);\r\n  this.load.bitmapFont('font','assets/fonts/teko-light_0.png',\r\n    'assets/fonts/teko-light.fnt', null, 5);\r\n\r\n  // load the sound for pieces\r\n  this.load.audio('piece', 'assets/soundfx/piece01.ogg', true);\r\n\r\n  // it will not be necessary to load this one if the player already passed the\r\n  // first part of the game\r\n  var skyName = BasicGame.Helper.prototype.getSkyName(BasicGame.currentLevel);\r\n  this.load.image(skyName, 'assets/images/' + skyName + '-min.png');\r\n\r\n  // load this if the current level stored requires it, otherwise load it\r\n  // when the player is near the end of the corresponding chapter\r\n  // this.load.image('spike-platform', 'assets/images/spike-platform.png');\r\n  // this.load.image('spike', 'assets/images/spike.png');\r\n  // this.load.image('spike-r', 'assets/images/spike-r.png');\r\n  // this.load.image('spike-l', 'assets/images/spike-l.png');\r\n  // this.load.image('spike-d', 'assets/images/spike-d.png');\r\n  // this.load.audio('spike', 'assets/soundfx/spike.ogg', true);\r\n\r\n  var levelData = BasicGame.Helper.prototype.getLevelIdAndName(BasicGame.currentLevel);\r\n  this.game.load.tilemap(levelData.id,\r\n    'assets/tilemaps/maps/' + levelData.name + '.json',\r\n    null,\r\n    Phaser.Tilemap.TILED_JSON);\r\n};\r\n\r\nBasicGame.Preloader.prototype.create = function(){\r\n  //Once the load has finished we disable the crop because we're going to sit in the update loop for a short while as the music decodes\r\n  this.preloadBar.cropEnabled = false;\r\n};\r\n\r\nBasicGame.Preloader.prototype.update = function(){\r\n  //this.cache.isSoundDecoded('mainMenuMusic')\r\n  if (this.ready === false) {\r\n    this.ready = true;\r\n    this.state.start('MainMenu');\r\n  }\r\n};\r\n",
    "var BasicGame = require('BasicGame');\r\n\r\nBasicGame.TheEnd = function (game) {\r\n  this.background = null;\r\n  this.fontId = 'font';\r\n  this.textColors = {\r\n    'H': 0x000000,\r\n    'B': 0xFFFFFF\r\n  };\r\n  this.dialogs = {\r\n    \"es\": [\r\n      {\r\n        character: 'B',\r\n        text: 'Han pasado 388 días desde que acabé con la vida de Margareth.',\r\n        bips: 3,\r\n        waitTime: 3\r\n      },\r\n      {\r\n        character: 'B',\r\n        text: 'Estuve a punto de darme por vencido unas # veces; de contarlo todo a la policía.',\r\n        bips: 5,\r\n        waitTime: 5\r\n      },\r\n      {\r\n        character: 'B',\r\n        text: 'Los primeros días fueron muy difíciles. Me costaba mucho evitar El Remordimiento.',\r\n        bips: 4,\r\n        waitTime: 5\r\n      },\r\n      {\r\n        character: 'B',\r\n        text: 'Pero lo he logrado.',\r\n        bips: 1,\r\n        waitTime: 2\r\n      },\r\n      {\r\n        character: 'B',\r\n        text: 'Ahora que lo pienso, beneficiarse de la muerte de otro no es algo malo.',\r\n        bips: 4,\r\n        waitTime: 5\r\n      },\r\n      {\r\n        character: 'B',\r\n        text: 'Creo que empiezo a entender la forma de pensar de mi hermano.',\r\n        bips: 3,\r\n        waitTime: 3\r\n      }\r\n    ],\r\n    \"en\": [\r\n      {\r\n        character: 'B',\r\n        text: '388 days has passed since I murdered Margareth.',\r\n        bips: 2,\r\n        waitTime: 3\r\n      },\r\n      {\r\n        character: 'B',\r\n        text: 'I was tempted to tell all to the police like 30 times.',\r\n        bips: 3,\r\n        waitTime: 4\r\n      },\r\n      {\r\n        character: 'B',\r\n        text: 'The first days were the hardest. It was very difficult to avoid The Remorse.',\r\n        bips: 4,\r\n        waitTime: 5\r\n      },\r\n      {\r\n        character: 'B',\r\n        text: 'But I succeeded.',\r\n        bips: 1,\r\n        waitTime: 2\r\n      },\r\n      {\r\n        character: 'B',\r\n        text: 'Now that I think about it, get benefit from another\\'s death is not such bad thing.',\r\n        bips: 4,\r\n        waitTime: 5\r\n      },\r\n      {\r\n        character: 'B',\r\n        text: 'I think I start to understand the way my brother thinks.',\r\n        bips: 3,\r\n        waitTime: 3\r\n      }\r\n    ]\r\n  };\r\n  this.textBitmapsGroup = null;\r\n  this.dialogNumber = 0;\r\n  this.BSound = null;\r\n  this.soundLoopTimer = null;\r\n  this.cloudsLimit = 9;\r\n\r\n  this.music = null;\r\n};\r\n\r\nBasicGame.TheEnd.prototype.preload = function() {\r\n  this.load.image('end_scene', 'assets/images/end_scene-min.png');\r\n  this.load.image('sun_light', 'assets/images/sun_light-min.png');\r\n  this.load.atlas('clouds', 'assets/sprites/clouds.png', 'assets/sprites/clouds.xml', null, Phaser.Loader.TEXTURE_ATLAS_XML_STARLING);\r\n  this.load.audio('the_end', 'assets/music/the_end.ogg', true);\r\n};\r\n\r\nBasicGame.TheEnd.prototype.create = function() {\r\n  // set the background for the scene\r\n  // this.game.stage.backgroundColor = 0x000000;\r\n  this.background = this.game.add.tileSprite(0, 0,\r\n    this.game.world.width, this.game.world.height, \"end_scene\");\r\n\r\n  // load the sound for B's voice\r\n  this.BSound = this.game.add.sound('b', 0.2);\r\n\r\n  // show the first line of The Confession\r\n  var firstDialogTimer = this.game.time.create(true);\r\n  firstDialogTimer.add(2500,\r\n    function(){\r\n      this.updateDialog();\r\n    },\r\n    this);\r\n  firstDialogTimer.start();\r\n\r\n  // create the loop that will generate clouds\r\n  this.cloudsContainer = this.game.add.group();\r\n\r\n  // fill the scene with 3 clouds\r\n  this.createCloud(true);\r\n  this.createCloud(true);\r\n  this.createCloud(true);\r\n\r\n  this.cloudsTimer = this.game.time.create(true);\r\n  this.cloudsTimer.loop(8000, function(){\r\n    this.createCloud();\r\n  }, this);\r\n  this.cloudsTimer.start();\r\n\r\n  // play the music\r\n  this.music = this.game.add.sound('the_end', 0.1, true);\r\n  this.music.play();\r\n\r\n  // add the sun light for the clouds\r\n  this.game.add.image(0, -96, 'sun_light').alpha = 0.5;\r\n\r\n  // create the group that will contain the dialog\r\n  this.textBitmapsGroup = this.game.add.group();\r\n  this.textBitmapsGroup.y = 10;\r\n  this.textBitmapsGroup.x = 0;\r\n};\r\n\r\nBasicGame.TheEnd.prototype.update = function(){};\r\n\r\nBasicGame.TheEnd.prototype.updateDialog = function(){\r\n  if(this.dialogNumber <= this.dialogs[BasicGame.language].length - 1){\r\n    var dialogObj = this.dialogs[BasicGame.language][this.dialogNumber];\r\n    // there are still dialogs to be shown\r\n    var currentDialogLine = dialogObj.text;\r\n    var character = dialogObj.character;\r\n\r\n    if (currentDialogLine.indexOf(\"#\") !== -1) {\r\n      currentDialogLine = currentDialogLine.replace(\"#\", BasicGame.getDeaths() || 500);\r\n    }\r\n\r\n    this.showText(this.createText(currentDialogLine, this.textColors[character]),\r\n      dialogObj.waitTime);\r\n\r\n    // play the bips of the dialog\r\n    if (dialogObj.bips > 0) {\r\n      this.soundLoopTimer = this.game.time.create(true);\r\n      this.soundLoopTimer.repeat(100, dialogObj.bips, function(){\r\n        this[dialogObj.character + \"Sound\"].play();\r\n      }, this);\r\n      this.soundLoopTimer.start();\r\n    }\r\n\r\n    this.dialogNumber++;\r\n  }\r\n};\r\n\r\nBasicGame.TheEnd.prototype.createText = function(text, tint) {\r\n  if (!this.yPosDialog) {\r\n    this.yPosDialog = 30;\r\n  }\r\n\r\n  var textBitmapsGroupChilds = this.textBitmapsGroup.children;\r\n  if (textBitmapsGroupChilds.length > 0) {\r\n    this.yPosDialog += textBitmapsGroupChilds[textBitmapsGroupChilds.length - 1].y + textBitmapsGroupChilds[textBitmapsGroupChilds.length - 1].height;\r\n    this.yPosDialog += 10;\r\n  }\r\n\r\n  var textsGroup = this.game.add.group(this.textBitmapsGroup);\r\n  textsGroup.alpha = 0;\r\n\r\n  var dialogTextShadowBitmap = this.add.bitmapText(42,\r\n    this.yPosDialog + 2,\r\n    this.fontId,\r\n    text,\r\n    40,\r\n    textsGroup);\r\n  dialogTextShadowBitmap.align = \"left\";\r\n  dialogTextShadowBitmap.anchor.set(0, 0);\r\n  dialogTextShadowBitmap.tint = 0x000000;\r\n  dialogTextShadowBitmap.maxWidth = this.game.world.width - 100;\r\n  dialogTextShadowBitmap.alpha = 0.6;\r\n\r\n  var dialogTextBitmap = this.add.bitmapText(40,\r\n    this.yPosDialog,\r\n    this.fontId,\r\n    text,\r\n    40,\r\n    textsGroup);\r\n  dialogTextBitmap.align = \"left\";\r\n  dialogTextBitmap.anchor.set(0, 0);\r\n  dialogTextBitmap.tint = tint || 0xFFFFFF;\r\n  dialogTextBitmap.maxWidth = this.game.world.width - 100;\r\n\r\n  return textsGroup;\r\n};\r\n\r\nBasicGame.TheEnd.prototype.showText = function(displayObj, timeForRead) {\r\n  this.dialogTween = this.game.add.tween(displayObj);\r\n  this.dialogTween.to({alpha: 1},\r\n    400,\r\n    Phaser.Easing.Quadratic.In,\r\n    false);\r\n  this.dialogTween.onComplete.addOnce(function() {\r\n    this.dialogTween.stop();\r\n\r\n    var nextDialogTimer = this.game.time.create(true);\r\n    nextDialogTimer.add(timeForRead * 1000,\r\n      function(){\r\n        this.updateDialog();\r\n      },\r\n      this);\r\n    nextDialogTimer.start();\r\n  }, this);\r\n  this.dialogTween.start();\r\n};\r\n\r\nBasicGame.TheEnd.prototype.getRandom = function(min, max) {\r\n  return Math.floor(Math.random()*(max-min+1)+min);\r\n};\r\n\r\nBasicGame.TheEnd.prototype.createCloud = function(insideScreen) {\r\n  // add the cloud out of the screen\r\n  var cloudX = 0;\r\n\r\n  if (insideScreen === true) {\r\n    cloudX = this.getRandom(100, this.game.world.width - 150);\r\n  }\r\n  else {\r\n    cloudX = this.game.world.width + this.getRandom(10, 20);\r\n  }\r\n\r\n  var cloudImg = this.game.add.image(cloudX, 0,\r\n    'clouds', 'cloud0' + this.getRandom(1, 9) + '.png', this.cloudsContainer);\r\n  cloudImg.y = this.getRandom(0-cloudImg.height/2, this.game.world.height - cloudImg.height - 210);\r\n  cloudImg.alpha = Math.min(Math.random(), 0.3);\r\n\r\n  // create the tween that will move the cloud\r\n  this.cloudTween = this.game.add.tween(cloudImg);\r\n  this.cloudTween.to({x: 0 - cloudImg.width - 20},\r\n    30000,\r\n    null,\r\n    false);\r\n  this.cloudTween.onComplete.addOnce(function() {\r\n    this.target.destroy();\r\n    this.stop();\r\n  }, this.cloudTween);\r\n  this.cloudTween.start();\r\n};"
  ]
}